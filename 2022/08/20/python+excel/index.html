<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>自动化办公（python+excel） | jjyaoao's Home</title><meta name="keywords" content="自动化办公（python+excel）"><meta name="author" content="jjyaoao,jjyaoao@126.com"><meta name="copyright" content="jjyaoao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="数值分析YYDS">
<meta property="og:type" content="article">
<meta property="og:title" content="自动化办公（python+excel）">
<meta property="og:url" content="http://jjyaoao.space/2022/08/20/python+excel/index.html">
<meta property="og:site_name" content="jjyaoao&#39;s Home">
<meta property="og:description" content="数值分析YYDS">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2022/04/15/YXoFfbxgWZIn1SM.png">
<meta property="article:published_time" content="2022-08-20T01:34:25.000Z">
<meta property="article:modified_time" content="2022-11-20T13:30:30.759Z">
<meta property="article:author" content="jjyaoao">
<meta property="article:tag" content="遗忘指南">
<meta property="article:tag" content="学习笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/04/15/YXoFfbxgWZIn1SM.png"><link rel="shortcut icon" href="https://s2.loli.net/2022/01/09/le6jcmPKuJihDdU.jpg"><link rel="canonical" href="http://jjyaoao.space/2022/08/20/python+excel/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?06fb7a80772d98cbf9e7beeb76e262e4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"JOZPQM4N5F","apiKey":"42451c032f2166ed9800520810e2d223","indexName":"jjyaoao-blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '自动化办公（python+excel）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-20 21:30:30'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2022/01/09/le6jcmPKuJihDdU.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">65</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">80</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音樂</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2022/04/15/YXoFfbxgWZIn1SM.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">jjyaoao's Home</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音樂</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">自动化办公（python+excel）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-20T01:34:25.000Z" title="发表于 2022-08-20 09:34:25">2022-08-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-20T13:30:30.759Z" title="更新于 2022-11-20 21:30:30">2022-11-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%97%A5%E5%B8%B8/">日常</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%97%A5%E5%B8%B8/%E8%BD%AF%E4%BB%B6%E5%AD%A6%E4%B9%A0/">软件学习</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%97%A5%E5%B8%B8/%E8%BD%AF%E4%BB%B6%E5%AD%A6%E4%B9%A0/python-excel/">python+excel</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">14.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>53分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="自动化办公（python+excel）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/190049765">一文上手sklearn机器学习库 - 知乎 (zhihu.com)</a></p>
<h2 id="Pandas工具简要介绍"><a href="#Pandas工具简要介绍" class="headerlink" title="Pandas工具简要介绍"></a>Pandas工具简要介绍</h2><p><img src="/2022/08/20/python+excel/image-20220908200620176.png" alt="image-20220908200620176"></p>
<p><img src="/2022/08/20/python+excel/image-20220908200638089.png" alt="image-20220908200638089"></p>
<h3 id="append"><a href="#append" class="headerlink" title="append()"></a>append()</h3><p><img src="/2022/08/20/python+excel/image-20220908200712630.png" alt="image-20220908200712630"></p>
<h3 id="join"><a href="#join" class="headerlink" title="join()"></a>join()</h3><p><img src="/2022/08/20/python+excel/image-20220908200738425.png" alt="image-20220908200738425"></p>
<h3 id="concat"><a href="#concat" class="headerlink" title="concat()"></a>concat()</h3><p><img src="/2022/08/20/python+excel/image-20220908200814352.png" alt="image-20220908200814352"></p>
<h3 id="merge"><a href="#merge" class="headerlink" title="merge()"></a>merge()</h3><p><img src="/2022/08/20/python+excel/image-20220908200903780.png" alt="image-20220908200903780"></p>
<h3 id="pivot-table"><a href="#pivot-table" class="headerlink" title="pivot_table()"></a>pivot_table()</h3><p><img src="/2022/08/20/python+excel/image-20220908201010241.png" alt="image-20220908201010241"></p>
<p>窗口操作 <img src="/2022/08/20/python+excel/image-20220908201119621.png" alt="image-20220908201119621"></p>
<h2 id="工作职位展示"><a href="#工作职位展示" class="headerlink" title="工作职位展示"></a>工作职位展示</h2><p><img src="/2022/08/20/python+excel/image-20220908201325868.png" alt="image-20220908201325868"></p>
<h2 id="Pandas简介"><a href="#Pandas简介" class="headerlink" title="Pandas简介"></a>Pandas简介</h2><p><img src="/2022/08/20/python+excel/image-20220908202022424.png" alt="image-20220908202022424"></p>
<p><img src="/2022/08/20/python+excel/image-20220908202119266.png" alt="image-20220908202119266"></p>
<p><img src="/2022/08/20/python+excel/image-20220908202146066.png" alt="image-20220908202146066"></p>
<p><img src="/2022/08/20/python+excel/image-20220908202217203.png" alt="image-20220908202217203"></p>
<p><img src="/2022/08/20/python+excel/image-20220908202331038.png" alt="image-20220908202331038"></p>
<h2 id="Series-amp-DataFrame"><a href="#Series-amp-DataFrame" class="headerlink" title="Series &amp; DataFrame"></a>Series &amp; DataFrame</h2><p><img src="/2022/08/20/python+excel/image-20220908202436952.png" alt="image-20220908202436952"></p>
<p><img src="/2022/08/20/python+excel/image-20220908202502773.png" alt="image-20220908202502773"></p>
<h2 id="read-excel-参数介绍"><a href="#read-excel-参数介绍" class="headerlink" title="read_excel()参数介绍"></a>read_excel()参数介绍</h2><p><img src="/2022/08/20/python+excel/image-20220908204235731.png" alt="image-20220908204235731"></p>
<h3 id="选择子表"><a href="#选择子表" class="headerlink" title="选择子表"></a>选择子表</h3><p><img src="/2022/08/20/python+excel/image-20220908204447740.png" alt="image-20220908204447740"></p>
<h3 id="指定表头"><a href="#指定表头" class="headerlink" title="指定表头"></a>指定表头</h3><p><img src="/2022/08/20/python+excel/image-20220908205021679.png" alt="image-20220908205021679"></p>
<p><img src="/2022/08/20/python+excel/image-20220908205628776.png" alt="image-20220908205628776"></p>
<p><img src="/2022/08/20/python+excel/image-20220908205605044.png" alt="image-20220908205605044"></p>
<h3 id="指定使用列"><a href="#指定使用列" class="headerlink" title="指定使用列"></a>指定使用列</h3><blockquote>
<p>强烈推荐str-list</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220908210136016.png" alt="image-20220908210136016"></p>
<p>获取str-list小彩蛋</p>
<p><img src="/2022/08/20/python+excel/image-20220908210315046.png" alt="image-20220908210315046"></p>
<p>对其<code>ctrl c</code></p>
<p><img src="/2022/08/20/python+excel/image-20220908210343553.png" alt="image-20220908210343553"></p>
<p>将不要的名字删除，再使用split函数</p>
<p><img src="/2022/08/20/python+excel/image-20220908210542096.png" alt="image-20220908210542096"></p>
<p>最后cv，一键得结果</p>
<p><img src="/2022/08/20/python+excel/image-20220908210625490.png" alt="image-20220908210625490"></p>
<h3 id="跳过不要的行"><a href="#跳过不要的行" class="headerlink" title="跳过不要的行"></a>跳过不要的行</h3><blockquote>
<p>跳过不要的列已经给你了usecols这个参数了，所以也无需单独设置</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220908210724840.png" alt="image-20220908210724840"></p>
<h3 id="设置列名"><a href="#设置列名" class="headerlink" title="设置列名"></a>设置列名</h3><p><img src="/2022/08/20/python+excel/image-20220908211038659.png" alt="image-20220908211038659"></p>
<h3 id="定义列名和类型"><a href="#定义列名和类型" class="headerlink" title="定义列名和类型"></a>定义列名和类型</h3><p><img src="/2022/08/20/python+excel/image-20220908211251300.png" alt="image-20220908211251300"></p>
<h4 id="dtype类型大全"><a href="#dtype类型大全" class="headerlink" title="dtype类型大全"></a>dtype类型大全</h4><blockquote>
<p>一般来说int65， float64，bool，datetime64[ns]，object系统可用推导出来，别的可能就要求手动了</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220908211319679.png" alt="image-20220908211319679"></p>
<blockquote>
<p>str与string的区别是，str默认保存为object对象</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220908212339477.png" alt="image-20220908212339477"></p>
<p>另外像季节品牌这些比较少的量可以设置为category，种类有两种好处</p>
<ul>
<li>节约内存</li>
<li>方便自定义排序</li>
</ul>
<p>我们设置dtype的目的是：<strong>不同类型的数据，有自己的一套函数，我们为了方便操作，因此得改变数据类型</strong></p>
<h3 id="自定义日期解析"><a href="#自定义日期解析" class="headerlink" title="自定义日期解析"></a>自定义日期解析</h3><blockquote>
<p>parse_dates是动词，解析日期，date_parser是名词，日期解析器</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909095501762.png" alt="image-20220909095501762"></p>
<h4 id="parse-dates"><a href="#parse-dates" class="headerlink" title="parse_dates"></a>parse_dates</h4><blockquote>
<p>不是True，False，就是列表，字典，不能单独传入一个列名，要加列表的括号</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909100344083.png" alt="image-20220909100344083"></p>
<blockquote>
<p>将分开的年月日类型拼接成一个日期类型</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909100615936.png" alt="image-20220909100615936"></p>
<p><img src="/2022/08/20/python+excel/image-20220909100651139.png" alt="image-20220909100651139"></p>
<p><img src="/2022/08/20/python+excel/image-20220909100739839.png" alt="image-20220909100739839"></p>
<blockquote>
<p>parse_dates的作用就是如此立竿见影</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909100042738.png" alt="image-20220909100042738"></p>
<blockquote>
<p>日期替换年_月_ 日</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909100231284.png" alt="image-20220909100231284"></p>
<h4 id="date-parser"><a href="#date-parser" class="headerlink" title="date_parser"></a>date_parser</h4><blockquote>
<p>其中一个 x 就是一个series</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909101457278.png" alt="image-20220909101457278"></p>
<p><img src="/2022/08/20/python+excel/image-20220909102754555.png" alt="image-20220909102754555"></p>
<h3 id="处理缺失值"><a href="#处理缺失值" class="headerlink" title="处理缺失值"></a>处理缺失值</h3><p><img src="/2022/08/20/python+excel/image-20220909103011140.png" alt="image-20220909103011140"></p>
<p><img src="/2022/08/20/python+excel/image-20220909103051258.png" alt="image-20220909103051258"></p>
<p><strong>实践</strong></p>
<p>​        我们来说明一下数据，首先第二行第二列是一个<strong>空格</strong>，这样的格式显然是不规范的，是一个小坑</p>
<p><img src="/2022/08/20/python+excel/image-20220909103300180.png" alt="image-20220909103300180"></p>
<p>​        我们只需要在na_values里输入一个<strong>列表</strong>，就可以把我们想要替换成缺失值的替换出去。</p>
<p>另外。下图excel表格中#N/A与#NA是默认会被解析为NaN的字符串</p>
<p><img src="/2022/08/20/python+excel/image-20220909103417266.png" alt="image-20220909103417266"></p>
<p>​        更多的，我们还可以传入一个<strong>字典</strong>进入na_values，指定我们想要替换的列（如果有想要替换的行直接转置就完事了，完全不麻烦）</p>
<p><img src="/2022/08/20/python+excel/image-20220909103729018.png" alt="image-20220909103729018"></p>
<h3 id="值转换（-）"><a href="#值转换（-）" class="headerlink" title="值转换（+-*/）"></a>值转换（+-*/）</h3><p><img src="/2022/08/20/python+excel/image-20220909104054303.png" alt="image-20220909104054303"></p>
<blockquote>
<p>Python strip() 方法用于移除字符串头尾指定的字符（默认为空格或换行符）或字符序列。</p>
<p><strong>注意：</strong>该方法只能删除开头或是结尾的字符，不能删除中间部分的字符。</p>
<p><code>lambda x: x.strip()</code> 也可以写成 <code>str.strip</code></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909104233001.png" alt="image-20220909104233001"></p>
<p>若要去除中间空格：</p>
<p><strong>1、使用字符串函数replace</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> a = <span class="string">&#x27;hello world&#x27;</span></span><br><span class="line"><span class="number">2</span> a.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="number">3</span> <span class="comment"># &#x27;helloworld&#x27;</span></span><br></pre></td></tr></table></figure>

<p><strong>2、使用字符串函数split</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> a = <span class="string">&#x27;&#x27;</span>.join(a.split())</span><br><span class="line"><span class="number">2</span> <span class="built_in">print</span>(a)</span><br><span class="line"><span class="number">3</span> <span class="comment"># helloworld</span></span><br></pre></td></tr></table></figure>

<p><strong>3、使用正则表达式</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">import</span> re</span><br><span class="line"><span class="number">2</span> strinfo = re.<span class="built_in">compile</span>()</span><br><span class="line"><span class="number">3</span> strinfo = re.<span class="built_in">compile</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="number">4</span> </span><br><span class="line"><span class="number">5</span> b = strinfo.sub(<span class="string">&#x27;&#x27;</span>, a)</span><br><span class="line"><span class="number">6</span> <span class="built_in">print</span>(b)</span><br><span class="line"><span class="number">7</span> <span class="comment"># helloworld</span></span><br></pre></td></tr></table></figure>

<p><strong>4、int（对于数字）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">content = <span class="built_in">input</span>(<span class="string">&quot;请输入内容:&quot;</span>).strip() <span class="comment">#可输入1 + 3</span></span><br><span class="line"><span class="comment"># print(&#x27;&#x27;.join(content.split()))</span></span><br><span class="line">index = content.find(<span class="string">&quot;+&quot;</span>)</span><br><span class="line">a = content[<span class="number">0</span>:index]</span><br><span class="line">b = content[index+<span class="number">1</span>:]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(a)+<span class="built_in">int</span>(b))  <span class="comment">#转化以后，自动去除空格</span></span><br></pre></td></tr></table></figure>

<h3 id="字符串转bool"><a href="#字符串转bool" class="headerlink" title="字符串转bool"></a>字符串转bool</h3><blockquote>
<p>只有一列全都转换，他才会转换成功，因为d为false，但是e、f没有在列表中，所以转化<strong>失败</strong></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909104847323.png" alt="image-20220909104847323"></p>
<blockquote>
<p>不过xxx_values无法对数字类型使用，要转换可以用之前讲到的dtype</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909105312619.png" alt="image-20220909105312619"></p>
<h3 id="其他参数补充"><a href="#其他参数补充" class="headerlink" title="其他参数补充"></a>其他参数补充</h3><h4 id="指定index"><a href="#指定index" class="headerlink" title="指定index"></a>指定index</h4><p><img src="/2022/08/20/python+excel/image-20220909105427608.png" alt="image-20220909105427608"></p>
<h4 id="是否转换数据为series"><a href="#是否转换数据为series" class="headerlink" title="是否转换数据为series"></a>是否转换数据为series</h4><p><img src="/2022/08/20/python+excel/image-20220909105458865.png" alt="image-20220909105458865"></p>
<h4 id="是否重命名列"><a href="#是否重命名列" class="headerlink" title="是否重命名列"></a>是否重命名列</h4><p><img src="/2022/08/20/python+excel/image-20220909105556928.png" alt="image-20220909105556928"></p>
<h4 id="指定解析行"><a href="#指定解析行" class="headerlink" title="指定解析行"></a>指定解析行</h4><blockquote>
<p>解析不包括表头，从表头下一行开始，如果包括表头，就是三行</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909105638367.png" alt="image-20220909105638367"></p>
<h4 id="字符串文本解析为数字"><a href="#字符串文本解析为数字" class="headerlink" title="字符串文本解析为数字"></a>字符串文本解析为数字</h4><p><img src="/2022/08/20/python+excel/image-20220909105756176.png" alt="image-20220909105756176"></p>
<h4 id="是否转浮点类型"><a href="#是否转浮点类型" class="headerlink" title="是否转浮点类型"></a>是否转浮点类型</h4><p><img src="/2022/08/20/python+excel/image-20220909105956630.png" alt="image-20220909105956630"></p>
<h2 id="to-excel-参数介绍"><a href="#to-excel-参数介绍" class="headerlink" title="to_excel()参数介绍"></a>to_excel()参数介绍</h2><p><img src="/2022/08/20/python+excel/image-20220909110204567.png" alt="image-20220909110204567"></p>
<h3 id="是否输出行索引"><a href="#是否输出行索引" class="headerlink" title="是否输出行索引"></a>是否输出行索引</h3><p><img src="/2022/08/20/python+excel/image-20220909110320017.png" alt="image-20220909110320017"></p>
<blockquote>
<p>即在’tb.xlsx’后面加上, index = False/True</p>
<p>同时我们也可以给行索引加上名字，也就是dataframe.index.name</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909110652280.png" alt="image-20220909110652280"></p>
<h3 id="命名表名，规范float格式，设置空"><a href="#命名表名，规范float格式，设置空" class="headerlink" title="命名表名，规范float格式，设置空"></a>命名表名，规范float格式，设置空</h3><p><img src="/2022/08/20/python+excel/image-20220909111111893.png" alt="image-20220909111111893"></p>
<p><img src="/2022/08/20/python+excel/image-20220909111241092.png" alt="image-20220909111241092"></p>
<h2 id="ExcelWriter-参数介绍"><a href="#ExcelWriter-参数介绍" class="headerlink" title="ExcelWriter()参数介绍"></a>ExcelWriter()参数介绍</h2><blockquote>
<p>他的优势就是可以输出两个表到同一个文件中</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909111438784.png" alt="image-20220909111438784"></p>
<p><img src="/2022/08/20/python+excel/image-20220909111528680.png" alt="image-20220909111528680"></p>
<p>假如不传datatime_format，那么输出默认就是</p>
<p><img src="/2022/08/20/python+excel/image-20220909111930198.png" alt="image-20220909111930198"></p>
<p>但实际工作中一般是不想看到这个时分秒的，但这都是看个人的需求了。</p>
<h2 id="写-读csv"><a href="#写-读csv" class="headerlink" title="写/读csv"></a>写/读csv</h2><p><img src="/2022/08/20/python+excel/image-20220909113451643.png" alt="image-20220909113451643"></p>
<blockquote>
<p> 默认采用index=False，不然读出来就不是标准格式了<img src="/2022/08/20/python+excel/image-20220909114106434.png" alt="image-20220909114106434"></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909113751619.png" alt="image-20220909113751619"></p>
<p>标准读出以后：<img src="/2022/08/20/python+excel/image-20220909114228303.png" alt="image-20220909114228303"></p>
<p>也可用<code>sep</code>指定分隔符<img src="/2022/08/20/python+excel/image-20220909114333179.png" alt="image-20220909114333179"></p>
<p><img src="/2022/08/20/python+excel/image-20220909114352686.png" alt="image-20220909114352686"></p>
<h2 id="读写pickle文件"><a href="#读写pickle文件" class="headerlink" title="读写pickle文件"></a>读写pickle文件</h2><p>​        pickle是一个二进制文件，用于将原本的xlsx或者csv文件转成机器语言，从而几百倍的提高读写效率，相当于一个全局变量，所以我们以后几乎就可以直接使用pickle来进行操作，从而最大成本的节省我们的时间，并且与直接读写csv效果是完全一样的。</p>
<p><img src="/2022/08/20/python+excel/image-20220909152118545.png" alt="image-20220909152118545"></p>
<blockquote>
<p>效果立竿见影</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909152935790.png" alt="image-20220909152935790"></p>
<h2 id="pandas-sql"><a href="#pandas-sql" class="headerlink" title="pandas + sql"></a>pandas + sql</h2><blockquote>
<p>我们需求：实现这样一个功能，将本地的excel表格存放到mysql中，如果还有2021年的数据，也同样创一个新的库</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220922110656710.png" alt="image-20220922110656710"></p>
<blockquote>
<p>1.安装依赖</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220922111621694.png" alt="image-20220922111621694"></p>
<blockquote>
<p>2.造库造表</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220922111528206.png" alt="image-20220922111528206"></p>
<blockquote>
<p>3.创建引擎</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220922111910540.png" alt="image-20220922111910540"></p>
<blockquote>
<p>读写执行sql语句</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220922113636511.png" alt="image-20220922113636511"></p>
<h3 id="to-sql"><a href="#to-sql" class="headerlink" title="to_sql"></a>to_sql</h3><blockquote>
<p>相关api</p>
<p>chunksize是为了避免你的内存装不下，每一次批量读取</p>
<p>if_exists的replace慎用，他会删除你的表并且创建一个新的表，尽量不用</p>
<p>​                append参数很常用，也就是把你当前dataframe的内容一行行追加到表中</p>
<p>​                fail是提醒你之前是否存在该表，如果已经存在这个表就报错</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220922113851130.png" alt="image-20220922113851130"></p>
<blockquote>
<p>实例如下</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建引擎</span></span><br><span class="line">con = create_engine(</span><br><span class="line">    <span class="string">&quot;mysql+pymysql://root:123456@localhost/sales2020&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读表</span></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;jd.xlsx&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 中文表名改为英文，应该和原表的英文名对应，插入会报错</span></span><br><span class="line">df = df.rename(columns=&#123;<span class="string">&#x27;货号&#x27;</span>: <span class="string">&#x27;goods_id&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;日期&#x27;</span>: <span class="string">&#x27;date&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;销量&#x27;</span>: <span class="string">&#x27;volume&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line">   goods_id       date  volume</span><br><span class="line"><span class="number">0</span>  YZFM1200 <span class="number">2020</span>-01-01       <span class="number">2</span></span><br><span class="line"><span class="number">1</span>  FLHR1800 <span class="number">2020</span>-01-02       <span class="number">5</span></span><br><span class="line"><span class="number">2</span>  LCHM9800 <span class="number">2020</span>-01-03       <span class="number">8</span></span><br><span class="line"><span class="number">3</span>  HWLA4700 <span class="number">2020</span>-01-04       <span class="number">6</span></span><br><span class="line"><span class="number">4</span>  UQNA9200 <span class="number">2020</span>-01-05      <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 两种形式均可写入sql</span></span><br><span class="line"><span class="comment"># pd.io.sql.to_sql(df, &#x27;jd&#x27;, con=con, if_exists=&#x27;append&#x27;, index=False)</span></span><br><span class="line"><span class="comment"># df.to_sql(&#x27;jd&#x27;, con=con, index=False, if_exists=&#x27;append&#x27;)</span></span><br></pre></td></tr></table></figure>

<h3 id="read-sql"><a href="#read-sql" class="headerlink" title="read_sql"></a>read_sql</h3><blockquote>
<p>参数说明：</p>
<p>第一个参数为选择表名或者直接输入语句吗，</p>
<p>con为选择引擎</p>
<p>columns可以选择列名，但是如果第一个参数是语句，则该句无效</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"></span><br><span class="line">con = create_engine(</span><br><span class="line">    <span class="string">&quot;mysql+pymysql://root:123456@localhost/sales2020&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1: 传入表名</span></span><br><span class="line">df = pd.read_sql(<span class="string">&#x27;jd&#x27;</span>, con=con,</span><br><span class="line">                 columns=[<span class="string">&#x27;goods_id&#x27;</span>, <span class="string">&#x27;volume&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2: 传入sql查询语句</span></span><br><span class="line">df = pd.read_sql(</span><br><span class="line">    <span class="string">&#x27;select goods_id,volume from jd where volume &gt; 5 order by volume&#x27;</span>,</span><br><span class="line">    con=con)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">    goods_id  volume</span><br><span class="line"><span class="number">0</span>   HWLA4700       <span class="number">6</span></span><br><span class="line"><span class="number">8</span>   LCHM9800       <span class="number">8</span></span><br><span class="line"><span class="number">23</span>  UQNA9200      <span class="number">10</span></span><br></pre></td></tr></table></figure>

<h3 id="mysql执行"><a href="#mysql执行" class="headerlink" title="mysql执行"></a>mysql执行</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 很简单，执行语句只需要用execute套住mysql代码就行。</span></span><br><span class="line">con.execute(<span class="string">&quot;insert into jd values (50 ,&#x27;aaa&#x27;,&#x27;2020-01-10&#x27;,100)&quot;</span>)</span><br><span class="line"><span class="comment"># con.execute(&quot;delete from jd where volume=100&quot;)</span></span><br><span class="line"><span class="comment"># con.execute(&quot;update jd set volume=1000 where goods_id=&#x27;UQNA9200&#x27;&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># con.execute(&quot;update school.students set 成绩=10 where id=1&quot;)</span></span><br></pre></td></tr></table></figure>





<h2 id="index索引"><a href="#index索引" class="headerlink" title="index索引"></a>index索引</h2><p><img src="/2022/08/20/python+excel/image-20220909161131997.png" alt="image-20220909161131997"></p>
<p><img src="/2022/08/20/python+excel/image-20220909161216526.png" alt="image-20220909161216526"></p>
<h3 id="识别"><a href="#识别" class="headerlink" title="识别"></a>识别</h3><p>​        通过每一个格子的索引，我们可以知道他具体代表的含义</p>
<p><img src="/2022/08/20/python+excel/image-20220909160350349.png" alt="image-20220909160350349"></p>
<h3 id="对齐"><a href="#对齐" class="headerlink" title="对齐"></a>对齐</h3><p>​        pandas在操作之前，会根据索引，自动帮我们将同一类型的实物对齐，例如下面这两个series是没有对齐的。</p>
<p><img src="/2022/08/20/python+excel/image-20220909160430530.png" alt="image-20220909160430530"></p>
<blockquote>
<p>所以相加之前，会将同类型的对齐，这就是<code>索引对齐</code>的作用</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909160536608.png" alt="image-20220909160536608"></p>
<blockquote>
<p>上下左右也同理，先对齐，在拼接</p>
</blockquote>
<img src="/2022/08/20/python+excel/image-20220909160826296.png" alt="image-20220909160826296" style="zoom: 67%;">

<p><img src="/2022/08/20/python+excel/image-20220909160903270.png" alt="image-20220909160903270"></p>
<h3 id="获取和设置"><a href="#获取和设置" class="headerlink" title="获取和设置"></a>获取和设置</h3><p><img src="/2022/08/20/python+excel/image-20220909161020989.png" alt="image-20220909161020989"></p>
<h2 id="查看dataframe基本信息"><a href="#查看dataframe基本信息" class="headerlink" title="查看dataframe基本信息"></a>查看dataframe基本信息</h2><p><img src="/2022/08/20/python+excel/image-20220909163402236.png" alt="image-20220909163402236"></p>
<h3 id="info"><a href="#info" class="headerlink" title="info()"></a>info()</h3><blockquote>
<p>打印摘要：如果有列显示的数字比244要少，那么他就是有空值，这里就没有空值</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909161645469.png" alt="image-20220909161645469"></p>
<h3 id="describe"><a href="#describe" class="headerlink" title="describe()"></a>describe()</h3><blockquote>
<p>描述性统计信息：只统计数字类型，非数字的不会统计</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909161858302.png" alt="image-20220909161858302"></p>
<blockquote>
<p>其中，std为样本标准差</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909162012304.png" alt="image-20220909162012304"></p>
<h3 id="什么是样本标准差"><a href="#什么是样本标准差" class="headerlink" title="什么是样本标准差"></a>什么是样本标准差</h3><p>​        举个例子，全国成年男性的身高是一个总体，我们想知道身高的标准差。最准确的测量办法就是对所有男性进行身高测量，然后求平均值，然后按照公式变换，最后除以n。</p>
<p>​        但是，测量全国所有男性身高几乎是不可能的事，或者说成本太高。</p>
<p>​        可我们就是想知道这个总体的标准差怎么办？</p>
<p>​        我们可以进行抽样，按照抽样规则，选取合适的样本量，抽取一定数量的男性测量，这个就是样本。可以肯定的是，样本的数量会比总体小很多（如果不是这样，那么抽样就没有意义）。测量样本的身高就要比测量总体简单多了。</p>
<p>​        对每个样本进行测量，得到身高用于计算标准差，那么这个标准差就是样本标准差。</p>
<h4 id="25"><a href="#25" class="headerlink" title="25%"></a>25%</h4><p>计算方法：，在这里就是只看1，2，然后再把<code>2 - 1</code>最后得到的这个<code>1 * 25%</code>，用 <code>2 - 0.25</code>即是最后的结果<code>1.75</code></p>
<p><img src="/2022/08/20/python+excel/image-20220909162749532.png" alt="image-20220909162749532"></p>
<h3 id="to-numpy"><a href="#to-numpy" class="headerlink" title="to_numpy()"></a>to_numpy()</h3><blockquote>
<p>将数据转化为numpy形式</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909162946283.png" alt="image-20220909162946283"></p>
<h3 id="其余一些参数的测试"><a href="#其余一些参数的测试" class="headerlink" title="其余一些参数的测试"></a>其余一些参数的测试</h3><blockquote>
<p>columns查看列索引，values转化为numpy，tolist转化为列表。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909163442302.png" alt="image-20220909163442302"></p>
<p><img src="/2022/08/20/python+excel/image-20220909163243939.png" alt="image-20220909163243939"></p>
<h2 id="Series查看数据基本信息"><a href="#Series查看数据基本信息" class="headerlink" title="Series查看数据基本信息"></a>Series查看数据基本信息</h2><blockquote>
<p>这些都和dataframe的大同小异</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909163536475.png" alt="image-20220909163536475"></p>
<h3 id="检查唯一性"><a href="#检查唯一性" class="headerlink" title="检查唯一性"></a>检查唯一性</h3><p><img src="/2022/08/20/python+excel/image-20220909163704945.png" alt="image-20220909163704945"></p>
<h4 id="方法展示"><a href="#方法展示" class="headerlink" title="方法展示"></a>方法展示</h4><blockquote>
<p>返回唯一存在的值</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909163813398.png" alt="image-20220909163813398"></p>
<p><img src="/2022/08/20/python+excel/image-20220909163923715.png" alt="image-20220909163923715"></p>
<h5 id="assert"><a href="#assert" class="headerlink" title="assert"></a>assert</h5><blockquote>
<p>assert函数相当于一个断点的功能，保证函数的参数是唯一的</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909164117576.png" alt="image-20220909164117576"></p>
<h3 id="检查长度"><a href="#检查长度" class="headerlink" title="检查长度"></a>检查长度</h3><p><img src="/2022/08/20/python+excel/image-20220909164253717.png" alt="image-20220909164253717"></p>
<p><img src="/2022/08/20/python+excel/image-20220909164310386.png" alt="image-20220909164310386"></p>
<h3 id="检查空值"><a href="#检查空值" class="headerlink" title="检查空值"></a>检查空值</h3><p><img src="/2022/08/20/python+excel/image-20220909164352921.png" alt="image-20220909164352921"></p>
<blockquote>
<p> 空值加法也会变成空值，因此我们必须处理掉空值</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909164608634.png" alt="image-20220909164608634"></p>
<p><img src="/2022/08/20/python+excel/image-20220909164551629.png" alt="image-20220909164551629"></p>
<h2 id="dick-like选择数据"><a href="#dick-like选择数据" class="headerlink" title="dick-like选择数据"></a>dick-like选择数据</h2><blockquote>
<p>series转dataframe：series.to_frame().reset_index()</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909165053119.png" alt="image-20220909165053119"></p>
<h3 id="mask选取"><a href="#mask选取" class="headerlink" title="mask选取"></a>mask选取</h3><blockquote>
<p>​        在实际生活中我们时常需要这样的取法，因为我们可以通过条件来生成mask，并且注意，如果我们以[  ]的方式来取数据，则是series，想要取得dataframe，就[[ ]]就行，再另外，注意观察[[True, False, True]]，首先数量是一样多得（不一样就报错），和行数，其次，为True的才显示，我们可以利用这个来筛选很多的数据！！！</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909170316319.png" alt="image-20220909170316319"></p>
<blockquote>
<p> 我们先创建掩码，选择我们想要的数据，得到以后就可以进行进一步操作（s为series列表）</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909170732837.png" alt="image-20220909170732837"></p>
<blockquote>
<p>当然我们也可以直接在括号中使用，跳过生成掩码这一部分</p>
<p>下面这个的意思是，取B这一列，返回数据中大于2，小于6的那一行</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909171021197.png" alt="image-20220909171021197"></p>
<p><strong>取反</strong></p>
<p><img src="/2022/08/20/python+excel/image-20220909171200709.png" alt="image-20220909171200709"></p>
<h2 id="list-like切片选数据"><a href="#list-like切片选数据" class="headerlink" title="list-like切片选数据"></a>list-like切片选数据</h2><blockquote>
<p>值得注意的是，数字切片左闭右开，字符串切片边界全取，另外切片都是切的行，=-=列通常都是读取数据后就选好了的吧</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909171533166.png" alt="image-20220909171533166"></p>
<h2 id="loc选数据"><a href="#loc选数据" class="headerlink" title="loc选数据"></a>loc选数据</h2><p><strong>取行可以不提列，取列必须提行</strong></p>
<blockquote>
<p> loc    –&gt;    location</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909171911387.png" alt="image-20220909171911387"></p>
<blockquote>
<p>一个值得关注的点，：代表选中全部  ：：-1代表选中全部，但是倒过来</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909172700223.png" alt="image-20220909172700223"></p>
<blockquote>
<p>甚至还可以给定步长 :: 2代表两步取一次，其实::-1的话，也就是每一步是-1，不断走，也便是倒序了</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909172813440.png" alt="image-20220909172813440"></p>
<h2 id="iloc选择数据"><a href="#iloc选择数据" class="headerlink" title="iloc选择数据"></a>iloc选择数据</h2><blockquote>
<p>i 就是<code>integer</code>,他和loc唯一的区别就是，iloc通常使用整数索引，这样使用的时候是不包括最后一个标签的，但是loc使用的时候包括最后一个，别的没变化。另外，loc适用范围广得多，iloc只能使用整数标签。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909201854562.png" alt="image-20220909201854562"></p>
<h2 id="Mutilndex多层索引"><a href="#Mutilndex多层索引" class="headerlink" title="Mutilndex多层索引"></a>Mutilndex多层索引</h2><h3 id="读写多层索引excel表"><a href="#读写多层索引excel表" class="headerlink" title="读写多层索引excel表"></a>读写多层索引excel表</h3><p>index_col基本能满足要求，但还是有所不足</p>
<p><img src="/2022/08/20/python+excel/image-20220909202936385.png" alt="image-20220909202936385"></p>
<p>如果列索引（销量）有名字的话，就显示在他左边的空格中。</p>
<p>​        这里，简单的读取，乍一看没问题，但其实我们可以发现发现，他把<strong>货号当成了列索引的名字</strong>，并且行索引没有名字，因此我们需要做一点小变动，具体就是<code>df.index.name = &#39;货号&#39; &amp; df.columns.names = [None, None]</code></p>
<p><img src="/2022/08/20/python+excel/image-20220909204115266.png" alt="image-20220909204115266"></p>
<blockquote>
<p>这个才是标准格式</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909204741441.png" alt="image-20220909204741441"></p>
<h3 id="创建多层索引"><a href="#创建多层索引" class="headerlink" title="创建多层索引"></a>创建多层索引</h3><blockquote>
<p>相邻两个相同，excel展示的时候会自动合并</p>
</blockquote>
<h4 id="list-like创建法"><a href="#list-like创建法" class="headerlink" title="list-like创建法"></a>list-like创建法</h4><p><img src="/2022/08/20/python+excel/image-20220909210956210.png" alt="image-20220909210956210"></p>
<h4 id="笛卡尔积创建"><a href="#笛卡尔积创建" class="headerlink" title="笛卡尔积创建"></a>笛卡尔积创建</h4><blockquote>
<p>a集合和b集合，以有序的方式一一对应合并，最终组成的大集合称为笛卡尔积</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220909211137854.png" alt="image-20220909211137854"></p>
<p><img src="/2022/08/20/python+excel/image-20220910160118307.png" alt="image-20220910160118307"></p>
<p>此外更多….</p>
<p><img src="/2022/08/20/python+excel/image-20220909211242338.png" alt="image-20220909211242338"></p>
<h3 id="已有表格基础生成Multindex"><a href="#已有表格基础生成Multindex" class="headerlink" title="已有表格基础生成Multindex"></a>已有表格基础生成Multindex</h3><p>在数模中，我们提炼二级指标说不定就可以用这个</p>
<h4 id="自定义生成随机样本"><a href="#自定义生成随机样本" class="headerlink" title="自定义生成随机样本"></a>自定义生成随机样本</h4><p><img src="/2022/08/20/python+excel/image-20220909211852063.png" alt="image-20220909211852063"></p>
<ul>
<li>sample()函数，n为生成的多少，replace为取出后是否放回，前面调用它的series的items就是原材料</li>
</ul>
<p><img src="/2022/08/20/python+excel/image-20220909212100083.png" alt="image-20220909212100083"></p>
<p>采用随机采样快速填充结果</p>
<p>groupby快速分组yyds</p>
<p><img src="/2022/08/20/python+excel/image-20220909212255776.png" alt="image-20220909212255776"></p>
<p>透视表等等在学！</p>
<p><img src="/2022/08/20/python+excel/image-20220909212439587.png" alt="image-20220909212439587"></p>
<p>无敌！</p>
<h4 id="多层索引取值"><a href="#多层索引取值" class="headerlink" title="多层索引取值"></a>多层索引取值</h4><blockquote>
<p>​        这个看看就好了！大概意思就是这个，有个注意点是，这种多层索引都是采用字典机制，所以，我们传入参数是(‘淘宝’，’M’)这样的形式</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910111621995.png" alt="image-20220910111621995"></p>
<p><img src="/2022/08/20/python+excel/image-20220910111552512.png" alt="image-20220910111552512"></p>
<blockquote>
<p>slice(None)的意思就是选择全部，不能用<code>:</code></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910112023626.png" alt="image-20220910112023626"></p>
<p><img src="/2022/08/20/python+excel/image-20220910112149590.png" alt="image-20220910112149590"></p>
<h3 id="数据赋值"><a href="#数据赋值" class="headerlink" title="数据赋值"></a>数据赋值</h3><p><img src="/2022/08/20/python+excel/image-20220910112410007.png" alt="image-20220910112410007"></p>
<blockquote>
<p>直接loc改也同样有效哦</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910112659468.png" alt="image-20220910112659468"></p>
<blockquote>
<p>总之一句话，灵活选择，务必记住loc是<strong>先行后列</strong>！</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910113216674.png" alt="image-20220910113216674"></p>
<h2 id="缺失值"><a href="#缺失值" class="headerlink" title="缺失值"></a>缺失值</h2><blockquote>
<p>python中缺失值的类别</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910113250362.png" alt="image-20220910113250362"></p>
<p>让我们来观察一下空值都长啥样</p>
<p><img src="/2022/08/20/python+excel/image-20220910113443606.png" alt="image-20220910113443606"></p>
<blockquote>
<p>df.convert_dtypes()可以自动将空值转化为最可能的形式，最常见的是<code>NaN</code></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910113753406.png" alt="image-20220910113753406"></p>
<h3 id="检测缺失值"><a href="#检测缺失值" class="headerlink" title="检测缺失值"></a>检测缺失值</h3><blockquote>
<p>isna()/isnull()      notna()/notnull() 相邻两行意思是完全一样的，输出的结果就是掩码，是空值的地方为True，其他是false </p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910114405073.png" alt="image-20220910114405073"></p>
<h3 id="删除缺失值"><a href="#删除缺失值" class="headerlink" title="删除缺失值"></a>删除缺失值</h3><blockquote>
<p>dropna()</p>
</blockquote>
<ul>
<li>axis = 0的意思就是选中行，也就是我们接下来的操作都是对一行一行的</li>
<li>how = ‘any’的意思是，只要哪一行有空值，无论一个还是多个，他都会进行删除   ‘all’的意思是必须这一行全部为空值，才进行删除</li>
<li>subset = None 的意思是检测所有的列，他可以传入一个列表，指定检测的列</li>
<li><strong>inplace = False</strong> 这个参数在大多函数中都有，意义是是否就地操作，如果为True那么就是就地执行操作，没有返回值，如果为False就是新开辟一个空间，并且返回操作后的结果</li>
</ul>
<p><img src="/2022/08/20/python+excel/image-20220910115042015.png" alt="image-20220910115042015"></p>
<blockquote>
<p>选中行删除，how为any，subset为None，inplace为False为系统默认</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910115147412.png" alt="image-20220910115147412"></p>
<h3 id="填充缺失值"><a href="#填充缺失值" class="headerlink" title="填充缺失值"></a>填充缺失值</h3><blockquote>
<p>fillna()</p>
</blockquote>
<ul>
<li>value = xx 默认填充值</li>
<li>method = ‘ffill’(forward)为遇到空值默认向前查找对应的值来填充、‘bfill’(back)遇到缺失值默认向后查找值来填充,注意，这里的前后，当axis为0时，默认为<strong>上下</strong>；为1时，默认为<strong>左右</strong></li>
<li> <code>value</code>和<code>method</code><strong>是必须传一个，而且也只能传一个</strong></li>
</ul>
<p><img src="/2022/08/20/python+excel/image-20220910115921412.png" alt="image-20220910115921412"></p>
<blockquote>
<p>同时value也可以填入dataframe，此时，他找就是找行列索引，如果是一样的，那么才将这个dataframe的值填入对应dataframe</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910120257414.png" alt="image-20220910120257414"></p>
<p><img src="/2022/08/20/python+excel/image-20220910120927716.png" alt="image-20220910120927716"></p>
<h4 id="实际工作中最常用"><a href="#实际工作中最常用" class="headerlink" title="实际工作中最常用"></a>实际工作中最常用</h4><p><img src="/2022/08/20/python+excel/image-20220910120617418.png" alt="image-20220910120617418"></p>
<blockquote>
<p>fillna只会填入空值（换言之，已存在的就不会填入）</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910120802160.png" alt="image-20220910120802160"></p>
<h3 id="线性插值"><a href="#线性插值" class="headerlink" title="线性插值"></a>线性插值</h3><blockquote>
<p>interpolate()，他只利用了相邻的前后两点，别的没用。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910121117523.png" alt="image-20220910121117523"></p>
<p><img src="/2022/08/20/python+excel/image-20220910121327145.png" alt="image-20220910121327145"></p>
<h2 id="数值运算"><a href="#数值运算" class="headerlink" title="数值运算"></a>数值运算</h2><h3 id="需要注意的问题"><a href="#需要注意的问题" class="headerlink" title="需要注意的问题"></a>需要注意的问题</h3><p><img src="/2022/08/20/python+excel/image-20220910153842970.png" alt="image-20220910153842970"></p>
<p><img src="/2022/08/20/python+excel/image-20220910153949406.png" alt="image-20220910153949406"></p>
<h4 id="对空值的处理"><a href="#对空值的处理" class="headerlink" title="对空值的处理"></a>对空值的处理</h4><blockquote>
<p>两种方法均可，第二种是运算的时候默认换成0</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910154042056.png" alt="image-20220910154042056"></p>
<h4 id="对除数为0的数"><a href="#对除数为0的数" class="headerlink" title="对除数为0的数"></a>对除数为0的数</h4><blockquote>
<p>用1来代表任何数</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910154156774.png" alt="image-20220910154156774"></p>
<p><img src="/2022/08/20/python+excel/image-20220910154247750.png" alt="image-20220910154247750"></p>
<h3 id="Series不对齐情况"><a href="#Series不对齐情况" class="headerlink" title="Series不对齐情况"></a>Series不对齐情况</h3><blockquote>
<p>用add、sub、mul、div这些，将其fill_value = 0 可以在计算时补0，使得仅并集计算，不会爆NaN错误</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910154900136.png" alt="image-20220910154900136"></p>
<h4 id="dataframe情况举例"><a href="#dataframe情况举例" class="headerlink" title="dataframe情况举例"></a>dataframe情况举例</h4><p><img src="/2022/08/20/python+excel/image-20220910155349887.png" alt="image-20220910155349887"></p>
<h3 id="Muitindex实现"><a href="#Muitindex实现" class="headerlink" title="Muitindex实现"></a>Muitindex实现</h3><blockquote>
<p>假如我们要将京东和淘宝的数据合并，并显示一个总需求，那我们应该怎么做呢？</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910155656861.png" alt="image-20220910155656861"></p>
<blockquote>
<p>这里我们采用笛卡儿积的方式进行匹配</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910160207453.png" alt="image-20220910160207453"></p>
<p><img src="/2022/08/20/python+excel/image-20220910160255162.png" alt="image-20220910160255162"></p>
<blockquote>
<p>到这里我们使用join函数就实现了需求了</p>
</blockquote>
<h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><h3 id="字符串操作"><a href="#字符串操作" class="headerlink" title="字符串操作"></a>字符串操作</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://regex101.com/">regex101: build, test, and debug regex</a></p>
<p>以下是最常用的一些：除此以外还有<code>\w</code> 匹配任意字符  <code>\d</code>  匹配数字  <code>a+</code>匹配延续字符</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910161905999.png" alt="image-20220910161905999"></p>
<blockquote>
<p>在python中我们常常导入这样的包，然后就使用这几个方法。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910162221814.png" alt="image-20220910162221814"></p>
<h4 id="findall"><a href="#findall" class="headerlink" title="findall()"></a>findall()</h4><p><img src="/2022/08/20/python+excel/image-20220910162635943.png" alt="image-20220910162635943"></p>
<h4 id="search"><a href="#search" class="headerlink" title="search()"></a>search()</h4><blockquote>
<p>注意，这个span，不是指找到了1、2，而是说<code>match=1</code>，它的位置索引是[1，2),也就是第一号的位置</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910162721060.png" alt="image-20220910162721060"></p>
<h4 id="split"><a href="#split" class="headerlink" title="split()"></a>split()</h4><blockquote>
<p>以数字进行拆分</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910162905025.png" alt="image-20220910162905025"></p>
<blockquote>
<p>这里使用r放在开头，表示他是一个原始的字符串，用[ xxxxx ]表示这里面的都需要匹配到，另外，如果再加一个参数为expand  =  True，那么series将变成一个dataframe</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910165129363.png" alt="image-20220910165129363"></p>
<img src="/2022/08/20/python+excel/image-20220910165300497.png" alt="image-20220910165300497" style="zoom:25%;">



<h4 id="sub"><a href="#sub" class="headerlink" title="sub()"></a>sub()</h4><blockquote>
<p>将\d找到的数字全部替换为*</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910163006605.png" alt="image-20220910163006605"></p>
<h4 id="replace"><a href="#replace" class="headerlink" title="replace()"></a>replace()</h4><blockquote>
<p>超过一个字符的，就视为正则表达式</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910165606990.png" alt="image-20220910165606990"></p>
<h4 id="cat"><a href="#cat" class="headerlink" title="cat()"></a>cat()</h4><p><img src="/2022/08/20/python+excel/image-20220910165729584.png" alt="image-20220910165729584"></p>
<h4 id="str取值与切片"><a href="#str取值与切片" class="headerlink" title="str取值与切片"></a>str取值与切片</h4><p><img src="/2022/08/20/python+excel/image-20220910165944474.png" alt="image-20220910165944474"></p>
<h4 id="extract-提取"><a href="#extract-提取" class="headerlink" title="extract()提取"></a>extract()提取</h4><blockquote>
<p>这里第一个参数传入一个正则表达式，注意是用括号括起来的，使用时必须有捕获组（capture group），其实一个括号括起来就代表一个捕获组，例如正则表达式<code>(\d&#123;4&#125;)-(\d&#123;2&#125;-(\d\d))</code>这个正则表达式可以用来匹配格式为yyyy-MM-dd的日期</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910170133718.png" alt="image-20220910170133718"></p>
<blockquote>
<p>另外(?P<name>xxx)这个是正则表达式的一个语法，可以给捕获组取到的东西命名</name></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910170826749.png" alt="image-20220910170826749"></p>
<h4 id="contain"><a href="#contain" class="headerlink" title="contain()"></a>contain()</h4><blockquote>
<p>在添加一个参数，na = False，即可将下图中<NA>转化为False</NA></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910170922121.png" alt="image-20220910170922121"></p>
<h4 id="get-dummies-获取独热编码"><a href="#get-dummies-获取独热编码" class="headerlink" title="get_dummies()获取独热编码"></a>get_dummies()获取独热编码</h4><p><img src="/2022/08/20/python+excel/image-20220910171156678.png" alt="image-20220910171156678"></p>
<h4 id="count-len"><a href="#count-len" class="headerlink" title="count()/len()"></a>count()/len()</h4><p><img src="/2022/08/20/python+excel/image-20220910171341782.png" alt="image-20220910171341782"></p>
<h4 id="pad-填充"><a href="#pad-填充" class="headerlink" title="pad()填充"></a>pad()填充</h4><p><img src="/2022/08/20/python+excel/image-20220910171506945.png" alt="image-20220910171506945"></p>
<p><img src="/2022/08/20/python+excel/image-20220910171532185.png" alt="image-20220910171532185"></p>
<h3 id="string类型"><a href="#string类型" class="headerlink" title="string类型"></a>string类型</h3><p><img src="/2022/08/20/python+excel/image-20220910163152969.png" alt="image-20220910163152969"></p>
<blockquote>
<p> 推荐使用<strong>StringDtype</strong>，避免混淆的情况</p>
</blockquote>
<h3 id="访问器"><a href="#访问器" class="headerlink" title="访问器"></a>访问器</h3><blockquote>
<p>使用之前必须保证调用元素都是string类型，不然可能出现一些意想不到的结果。</p>
<p>可以使用<code>astype</code>进行转换。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910163835999.png" alt="image-20220910163835999"></p>
<p><img src="/2022/08/20/python+excel/image-20220910163447025.png" alt="image-20220910163447025"></p>
<h4 id="访问器应用实操"><a href="#访问器应用实操" class="headerlink" title="访问器应用实操"></a>访问器应用实操</h4><p><img src="/2022/08/20/python+excel/image-20220910164037140.png" alt="image-20220910164037140"></p>
<blockquote>
<p>第一列多加了空格，第二列最后为文本，第三列最后也为文本，但我们用pandas读入之后是这样的，数据量多了之后很难发现有什么问题</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910164112622.png" alt="image-20220910164112622"></p>
<blockquote>
<p>如果我们应用了一个convert_dtypes()之后仍然发生数据类型对不上的情况，很有可能数据源就是有问题的</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910164318336.png" alt="image-20220910164318336"></p>
<blockquote>
<p>这个时候怎么处理呢？</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910164740983.png" alt="image-20220910164740983"></p>
<h2 id="时间"><a href="#时间" class="headerlink" title="时间"></a>时间</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#timeseries-offset-aliases">Time series / date functionality — pandas 1.4.4 documentation (pydata.org)</a>    如果不知道有哪些时间类型，点我进入</p>
</blockquote>
<h3 id="时间类型"><a href="#时间类型" class="headerlink" title="时间类型"></a>时间类型</h3><blockquote>
<p>通常舍弃最后一个时间偏移量，用时间增量来代替</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220910172150949.png" alt="image-20220910172150949"></p>
<h3 id="时间点-时间段"><a href="#时间点-时间段" class="headerlink" title="时间点/时间段"></a>时间点/时间段</h3><p><img src="/2022/08/20/python+excel/image-20220910172337459.png" alt="image-20220910172337459"></p>
<h3 id="时间增量-时间偏移"><a href="#时间增量-时间偏移" class="headerlink" title="时间增量/时间偏移"></a>时间增量/时间偏移</h3><p><img src="/2022/08/20/python+excel/image-20220910172516309.png" alt="image-20220910172516309"></p>
<h4 id="实例演示"><a href="#实例演示" class="headerlink" title="实例演示"></a>实例演示</h4><blockquote>
<p>Timedelta和DataOffset可以与其他时间点进行运算。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911094757780.png" alt="image-20220911094757780"></p>
<blockquote>
<p>1月1号加一个工作日变成了2号，这没问题，一月二号加两个工作日变成了六号，这是因为二号是周五了，于是他跳过了周六周日，再加了两个工作日到周二，也就是六号</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911095145985.png" alt="image-20220911095145985"></p>
<blockquote>
<p>指定读入类型，但如果我们直接用convert_dtypes()，则会有可能Timedelta转换错误</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911100010596.png" alt="image-20220911100010596"></p>
<p><img src="/2022/08/20/python+excel/image-20220911100142513.png" alt="image-20220911100142513"></p>
<h3 id="转换时间序列"><a href="#转换时间序列" class="headerlink" title="转换时间序列"></a>转换时间序列</h3><blockquote>
<p>to_datetime()</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911100254078.png" alt="image-20220911100254078"></p>
<blockquote>
<p>coerce转成NaT，也就是说，转换成功的转换，转换不成功的自动转换成时间类型的空值</p>
</blockquote>
<img src="/2022/08/20/python+excel/image-20220911100318130.png" alt="image-20220911100318130" style="zoom: 50%;">

<p><img src="/2022/08/20/python+excel/image-20220911100618610.png" alt="image-20220911100618610"></p>
<h3 id="生成时间戳范围"><a href="#生成时间戳范围" class="headerlink" title="生成时间戳范围"></a>生成时间戳范围</h3><blockquote>
<p>date_range()</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911101248643.png" alt="image-20220911101248643"></p>
<p><img src="/2022/08/20/python+excel/image-20220911101303236.png" alt="image-20220911101303236"></p>
<blockquote>
<p><strong>B和C为取工作日</strong> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/tujia/p/15875996.html">pandas date_range freq 可选值 - Tiac - 博客园 (cnblogs.com)</a></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911101341075.png" alt="image-20220911101341075"></p>
<p><img src="/2022/08/20/python+excel/image-20220911101349772.png" alt="image-20220911101349772"></p>
<h3 id="时间序列访问器"><a href="#时间序列访问器" class="headerlink" title="时间序列访问器"></a>时间序列访问器</h3><p><img src="/2022/08/20/python+excel/image-20220911104003661.png" alt="image-20220911104003661"></p>
<h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><p><img src="/2022/08/20/python+excel/image-20220911104056919.png" alt="image-20220911104056919"></p>
<h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><p><img src="/2022/08/20/python+excel/image-20220911104219007.png" alt="image-20220911104219007"></p>
<h3 id="Period创建"><a href="#Period创建" class="headerlink" title="Period创建"></a>Period创建</h3><p><img src="/2022/08/20/python+excel/image-20220911104538525.png" alt="image-20220911104538525"></p>
<p><img src="/2022/08/20/python+excel/image-20220911104546237.png" alt="image-20220911104546237"></p>
<blockquote>
<p>start_time、end_time是时间点，也就是后面有0时0分0秒那种</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911104609628.png" alt="image-20220911104609628"></p>
<h3 id="Timetelta时间间隔"><a href="#Timetelta时间间隔" class="headerlink" title="Timetelta时间间隔"></a>Timetelta时间间隔</h3><h4 id="Timedelta"><a href="#Timedelta" class="headerlink" title="Timedelta()"></a>Timedelta()</h4><p><img src="/2022/08/20/python+excel/image-20220911105126680.png" alt="image-20220911105126680"></p>
<blockquote>
<p>unit用法</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911105256822.png" alt="image-20220911105256822"></p>
<h4 id="to-timedelta"><a href="#to-timedelta" class="headerlink" title="to_timedelta()"></a>to_timedelta()</h4><p><img src="/2022/08/20/python+excel/image-20220911105545532.png" alt="image-20220911105545532"></p>
<h4 id="timedelta-range"><a href="#timedelta-range" class="headerlink" title="timedelta_range()"></a>timedelta_range()</h4><p><img src="/2022/08/20/python+excel/image-20220911105656731.png" alt="image-20220911105656731"></p>
<blockquote>
<p>更多详情，请见<a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/reference/api/pandas.Timestamp.html">pandas.Timestamp — pandas 1.4.4 documentation (pydata.org)</a></p>
</blockquote>
<h3 id="时间序列索引"><a href="#时间序列索引" class="headerlink" title="时间序列索引"></a>时间序列索引</h3><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><p><img src="/2022/08/20/python+excel/image-20220911110456841.png" alt="image-20220911110456841"></p>
<p><img src="/2022/08/20/python+excel/image-20220911110348657.png" alt="image-20220911110348657"></p>
<p><img src="/2022/08/20/python+excel/image-20220911110418360.png" alt="image-20220911110418360"></p>
<p><img src="/2022/08/20/python+excel/image-20220911110552945.png" alt="image-20220911110552945"></p>
<h4 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h4><p><img src="/2022/08/20/python+excel/image-20220911110701199.png" alt="image-20220911110701199"></p>
<p><img src="/2022/08/20/python+excel/image-20220911110808178.png" alt="image-20220911110808178"></p>
<h2 id="多表合并"><a href="#多表合并" class="headerlink" title="多表合并"></a>多表合并</h2><h3 id="append-上下合并"><a href="#append-上下合并" class="headerlink" title="append()上下合并"></a>append()上下合并</h3><ul>
<li><code>to_append</code>和<code>other</code>名字不一样，但作用都是一样的，指定将要合并的表的类型</li>
<li><code>ignore_index</code>是否忽略索引</li>
<li><code>verify_integrity</code>是否检查有重复的行索引</li>
<li><code>sort</code>对列名进行排序</li>
</ul>
<p><img src="/2022/08/20/python+excel/image-20220911111302547.png" alt="image-20220911111302547"></p>
<h4 id="实例演示-1"><a href="#实例演示-1" class="headerlink" title="实例演示"></a>实例演示</h4><blockquote>
<p>我们关注这种没有对齐的情况，看看它是怎么操作的</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911111618028.png" alt="image-20220911111618028"></p>
<blockquote>
<p>它创造出具有空值的对应列，然后将其append上下拼接</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911111700075.png" alt="image-20220911111700075"></p>
<blockquote>
<p>当ignore_index=True时，索引就从1月、2月、3月变成0、1、2</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911111818524.png" alt="image-20220911111818524"></p>
<blockquote>
<p>verify_integrity=True，为检查行索引是否有重复，如果重复会报错。如果设置为<strong>False</strong>，<strong>会导致列名重复，多出重复列</strong>，默认为False</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911111932966.png" alt="image-20220911111932966"></p>
<blockquote>
<p>sort设置为True，自动排序列索引，将这个BAC转换为ABC</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911112003645.png" alt="image-20220911112003645"></p>
<h4 id="合并文件夹的表格"><a href="#合并文件夹的表格" class="headerlink" title="合并文件夹的表格"></a>合并文件夹的表格</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">使用 append() 函数</span></span><br><span class="line"><span class="string">合并一个文件夹里面的全部表格</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">v_concat_files</span>(<span class="params">folder: <span class="built_in">str</span></span>) -&gt; pd.DataFrame:</span></span><br><span class="line">    df_all = pd.DataFrame()</span><br><span class="line">    <span class="keyword">for</span> fn <span class="keyword">in</span> os.listdir(folder):</span><br><span class="line">        ffn = os.path.join(folder, fn)</span><br><span class="line">        <span class="built_in">print</span>(ffn)</span><br><span class="line">        df_temp = pd.read_excel(ffn)</span><br><span class="line">        df_all = df_all.append(df_temp)</span><br><span class="line">    <span class="keyword">return</span> df_all</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># df_A = v_concat_files(</span></span><br><span class="line">    <span class="comment">#     &#x27;/Users/Yi/Mirror/我的python教程/Pandas办公自动化/z_data_source/PlatformA&#x27;</span></span><br><span class="line">    <span class="comment"># )</span></span><br><span class="line">    <span class="comment"># df_A.info()</span></span><br><span class="line">    <span class="comment"># print(df_A.head())</span></span><br><span class="line">    <span class="comment"># df_A.to_excel(&#x27;all_A.xlsx&#x27;)</span></span><br><span class="line">    <span class="comment"># df_A[&#x27;平台&#x27;] = &#x27;平台A&#x27;</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># with pd.ExcelWriter(</span></span><br><span class="line">    <span class="comment">#     &#x27;all_A.xlsx&#x27;,</span></span><br><span class="line">    <span class="comment">#     datetime_format=&#x27;YYYY-MM-DD&#x27;</span></span><br><span class="line">    <span class="comment"># ) as writer:</span></span><br><span class="line">    <span class="comment">#     df_A.to_excel(writer, index=False)</span></span><br><span class="line"></span><br><span class="line">    df_B = v_concat_files(</span><br><span class="line">        <span class="string">&#x27;/Users/Yi/Mirror/我的python教程/Pandas办公自动化/z_data_source/PlatformB&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    df_B[<span class="string">&#x27;平台&#x27;</span>] = <span class="string">&#x27;平台B&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> pd.ExcelWriter(</span><br><span class="line">        <span class="string">&#x27;all_B.xlsx&#x27;</span>,</span><br><span class="line">        datetime_format=<span class="string">&#x27;YYYY-MM-DD&#x27;</span></span><br><span class="line">    ) <span class="keyword">as</span> writer:</span><br><span class="line">        df_B.to_excel(writer, index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h3 id="join-左右合并"><a href="#join-左右合并" class="headerlink" title="join()左右合并"></a>join()左右合并</h3><ul>
<li>第一个参数<code>other</code>就是将要与调用join方法的东西合并的东西</li>
<li>how参数指定合并的方式，默认是<code>left</code>(依靠左表) <code>right</code>(依靠右表)  <code>outer</code>(依靠两个表, 并集)  <code>inner</code>(依靠两个表的交集)</li>
<li>lsuffix和rsuffix就是左后缀和右后缀，它们的意思就是，如果合并之后有相同的列名，那么左边\右边的表格就会加上的后缀</li>
<li>sort是排序，它是对index进行排序，也就是对行进行排序，默认是False</li>
</ul>
<p><img src="/2022/08/20/python+excel/image-20220911145438775.png" alt="image-20220911145438775"></p>
<h4 id="拼接series"><a href="#拼接series" class="headerlink" title="拼接series"></a>拼接series</h4><p><img src="/2022/08/20/python+excel/image-20220911150045654.png" alt="image-20220911150045654"></p>
<p><img src="/2022/08/20/python+excel/image-20220911150534192.png" alt="image-20220911150534192"></p>
<h4 id="拼接dataframe"><a href="#拼接dataframe" class="headerlink" title="拼接dataframe"></a>拼接dataframe</h4><blockquote>
<p>how = outer、left、right、inner</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911150833927.png" alt="image-20220911150833927"></p>
<h4 id="实例演示-2"><a href="#实例演示-2" class="headerlink" title="实例演示"></a>实例演示</h4><blockquote>
<p>下面是使用lshffix和rsuffix的实例</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911151151362.png" alt="image-20220911151151362"></p>
<blockquote>
<p>join形成列表</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911152045911.png" alt="image-20220911152045911"></p>
<h3 id="concat-左右-上下合并"><a href="#concat-左右-上下合并" class="headerlink" title="concat()左右/上下合并"></a>concat()左右/上下合并</h3><ul>
<li>objs：使用对象可以是列表/字典</li>
<li>axis=0 默认是append，进行上下拼接，1就是左右合并</li>
<li>join： 只有outer inner</li>
<li>keys的作用见下面，ignore_index 和 verify_integrity都为之前讲过的</li>
</ul>
<p><img src="/2022/08/20/python+excel/image-20220911152138169.png" alt="image-20220911152138169"></p>
<h4 id="一次性读多表"><a href="#一次性读多表" class="headerlink" title="一次性读多表"></a>一次性读多表</h4><blockquote>
<p>每一次的储存形式就是列表</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911152556028.png" alt="image-20220911152556028"></p>
<p><img src="/2022/08/20/python+excel/image-20220911152706112.png" alt="image-20220911152706112"></p>
<h4 id="keys的作用"><a href="#keys的作用" class="headerlink" title="keys的作用"></a>keys的作用</h4><p><img src="/2022/08/20/python+excel/image-20220911152857146.png" alt="image-20220911152857146"></p>
<blockquote>
<p>当然，如果直接传入字典的话效果与上面这种一样，了解即可</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911153117161.png" alt="image-20220911153117161"></p>
<h3 id="merge-联合"><a href="#merge-联合" class="headerlink" title="merge()联合"></a>merge()联合</h3><blockquote>
<p>先来看一个简单的实例: 在工作中，可能时常会遇到，将两个表合并在一起，通过一定的索引什么的，这个时候就要用到merge()</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911153551765.png" alt="image-20220911153551765"></p>
<blockquote>
<p>例如我们期望的样子就是下面这样</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911153655384.png" alt="image-20220911153655384"></p>
<h4 id="1：1"><a href="#1：1" class="headerlink" title="1：1"></a>1：1</h4><p><img src="/2022/08/20/python+excel/image-20220911153836787.png" alt="image-20220911153836787"></p>
<p><img src="/2022/08/20/python+excel/image-20220911153939870.png" alt="image-20220911153939870"></p>
<p>就这种情况的话，用join()，append()，concat都可以很好得满足任务</p>
<h4 id="M：1"><a href="#M：1" class="headerlink" title="M：1"></a>M：1</h4><p><img src="/2022/08/20/python+excel/image-20220911154058099.png" alt="image-20220911154058099"></p>
<p><img src="/2022/08/20/python+excel/image-20220911154139644.png" alt="image-20220911154139644"></p>
<h4 id="M：M"><a href="#M：M" class="headerlink" title="M：M"></a>M：M</h4><p>同样也是根据KEY这一列来进行合并，拼接的时候是使用笛卡尔积的方式，也就是说，全排列。</p>
<p><img src="/2022/08/20/python+excel/image-20220911154207832.png" alt="image-20220911154207832"></p>
<p><img src="/2022/08/20/python+excel/image-20220911154257864.png" alt="image-20220911154257864"></p>
<p><img src="/2022/08/20/python+excel/image-20220911154343603.png" alt="image-20220911154343603"></p>
<blockquote>
<p>merge的on就是选择哪一列作为索引，别的join，append()都有这个参数，如果两个表格中，索引的名字不一样，那么可以这样，设置left_on、right_on，不过一般excel都可以移动位置，或者你直接去改一下名字就行了，没必要这么麻烦，就算合并起来了还不是要删除一列。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(df1, df2,     </span><br><span class="line">         on=<span class="string">&#x27;货号&#x27;</span>,     </span><br><span class="line">         how=<span class="string">&#x27;left&#x27;</span>,     </span><br><span class="line">         validate=<span class="string">&#x27;m:1&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/20/python+excel/image-20220911155343882.png" alt="image-20220911155343882"></p>
<h4 id="可能会遇到的问题"><a href="#可能会遇到的问题" class="headerlink" title="可能会遇到的问题"></a>可能会遇到的问题</h4><blockquote>
<p>在电商平台我们可能会出现一个问题，右边的基础信息表，我们不小心出复制了一个牛仔裤，这样的话，如果merge，会导致销量这个本只应该是10的数字变成18</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911160355896.png" alt="image-20220911160355896"></p>
<p><img src="/2022/08/20/python+excel/image-20220911160534400.png" alt="image-20220911160534400"></p>
<h5 id="validate"><a href="#validate" class="headerlink" title="validate"></a>validate</h5><blockquote>
<p>在我们指定模式为多对一的形式，如果右边的索引出现不唯一的情况，就会报错，从而解决掉隐患</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911161002215.png" alt="image-20220911161002215"></p>
<h4 id="使用列表共同匹配"><a href="#使用列表共同匹配" class="headerlink" title="使用列表共同匹配"></a>使用列表共同匹配</h4><p><img src="/2022/08/20/python+excel/image-20220911161711466.png" alt="image-20220911161711466"> </p>
<h2 id="透视表"><a href="#透视表" class="headerlink" title="透视表"></a>透视表</h2><h3 id="pivot"><a href="#pivot" class="headerlink" title="pivot()"></a>pivot()</h3><blockquote>
<p>pivot（）呈现效果:</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911161906361.png" alt="image-20220911161906361"></p>
<p><img src="/2022/08/20/python+excel/image-20220911162330607.png" alt="image-20220911162330607"></p>
<blockquote>
<p> 但是如果当出现重复数据。。。。pivot()表示无能为力，pivot_table()出场</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911162037736.png" alt="image-20220911162037736"></p>
<h3 id="pivot-table-1"><a href="#pivot-table-1" class="headerlink" title="pivot_table()"></a>pivot_table()</h3><p><img src="/2022/08/20/python+excel/image-20220911162212047.png" alt="image-20220911162212047"></p>
<blockquote>
<p>实例演示</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911162702800.png" alt="image-20220911162702800"></p>
<p><img src="/2022/08/20/python+excel/image-20220911162715585.png" alt="image-20220911162715585"></p>
<blockquote>
<p>如果不传入columns，那么就用values来当做列索引</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911163340544.png" alt="image-20220911163340544"></p>
<blockquote>
<p>另外，对不同的value做不同的处理，用字典来传入方法</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911163444430.png" alt="image-20220911163444430"></p>
<blockquote>
<p>这次我们加上columns</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911163623980.png" alt="image-20220911163623980"></p>
<blockquote>
<p>甚至列名还可以调用时间的迭代器，这里采用了季度来统计</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911164013023.png" alt="image-20220911164013023"></p>
<h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">aggfunc: aggregate function</span></span><br><span class="line"><span class="string">聚合函数    </span></span><br><span class="line"><span class="string">求和:   sum, &#x27;sum&#x27;, np.sum    </span></span><br><span class="line"><span class="string">求均值: &#x27;mean&#x27;, np.mean(默认)    </span></span><br><span class="line"><span class="string">最大值: max, &#x27;max&#x27;, np.max    </span></span><br><span class="line"><span class="string">最小值: min, &#x27;min&#x27;, np.min    </span></span><br><span class="line"><span class="string">数量:   &#x27;count&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p> <strong>从某种意义上来讲，pivot_table（）能满足你的所有需求</strong></p>
</blockquote>
<h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><p><img src="/2022/08/20/python+excel/image-20220911170207887.png" alt="image-20220911170207887"></p>
<h3 id="sort-index"><a href="#sort-index" class="headerlink" title="sort_index()"></a>sort_index()</h3><blockquote>
<p>axis=0时，他根据索引大小进行排序,如果是axis=1，就是根据列名进行排序</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911164530614.png" alt="image-20220911164530614"></p>
<p><img src="/2022/08/20/python+excel/image-20220911164612030.png" alt="image-20220911164612030"></p>
<h4 id="ascending"><a href="#ascending" class="headerlink" title="ascending"></a>ascending</h4><blockquote>
<p>ascending参数默认为True，就是升序的意思，我们设置为False，就是降序输出</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911165953889.png" alt="image-20220911165953889"></p>
<h3 id="soft-values"><a href="#soft-values" class="headerlink" title="soft_values()"></a>soft_values()</h3><blockquote>
<p>axis=0时，对A列的所有行进行排序</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911164657954.png" alt="image-20220911164657954"></p>
<p><img src="/2022/08/20/python+excel/image-20220911164800626.png" alt="image-20220911164800626"></p>
<h3 id="CateGoricalDtype"><a href="#CateGoricalDtype" class="headerlink" title="CateGoricalDtype()"></a>CateGoricalDtype()</h3><p><img src="/2022/08/20/python+excel/image-20220911165809725.png" alt="image-20220911165809725"></p>
<h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><blockquote>
<p>我们做一个透视表操作，这是代码的默认排序</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911170431283.png" alt="image-20220911170431283"></p>
<blockquote>
<p>现在我们用CategoricalDtype()来设置我们自己的顺序</p>
<p><code>ordered</code>参数就是是否已经排好序，这里选择<code>True</code></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911171022632.png" alt="image-20220911171022632"></p>
<blockquote>
<p>用astype指定为自己的类型</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911171133222.png" alt="image-20220911171133222"></p>
<blockquote>
<p>设置完类型之后再次使用透视表，即可得到想要的结果</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911171328179.png" alt="image-20220911171328179"></p>
<h3 id="排序拓展"><a href="#排序拓展" class="headerlink" title="排序拓展"></a>排序拓展</h3><p><img src="/2022/08/20/python+excel/image-20220911171641345.png" alt="image-20220911171641345"></p>
<h2 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h2><h3 id="groupby-分组"><a href="#groupby-分组" class="headerlink" title="groupby()分组"></a>groupby()分组</h3><p><img src="/2022/08/20/python+excel/image-20220911171834531.png" alt="image-20220911171834531"></p>
<h4 id="拆分多个组"><a href="#拆分多个组" class="headerlink" title="拆分多个组"></a>拆分多个组</h4><h5 id="PPT演示"><a href="#PPT演示" class="headerlink" title="PPT演示"></a>PPT演示</h5><p><img src="/2022/08/20/python+excel/image-20220911171930950.png" alt="image-20220911171930950"></p>
<p><img src="/2022/08/20/python+excel/image-20220911172008810.png" alt="image-20220911172008810"></p>
<p><img src="/2022/08/20/python+excel/image-20220911172155205.png" alt="image-20220911172155205"></p>
<h5 id="代码验证"><a href="#代码验证" class="headerlink" title="代码验证"></a>代码验证</h5><p><img src="/2022/08/20/python+excel/image-20220911172406222.png" alt="image-20220911172406222"></p>
<h4 id="分组后操作"><a href="#分组后操作" class="headerlink" title="分组后操作"></a>分组后操作</h4><blockquote>
<p>分组后一般进行的三种操作</p>
</blockquote>
<h5 id="聚合"><a href="#聚合" class="headerlink" title="聚合"></a>聚合</h5><blockquote>
<p>直接压扁，总之返回一个新的dataframe</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911172532188.png" alt="image-20220911172532188"></p>
<h5 id="转换"><a href="#转换" class="headerlink" title="转换"></a>转换</h5><blockquote>
<p>他的索引跟原来的dataframe索引是一致的，也就是说我们总是新增一列来接受转换后的结果，</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911172647347.png" alt="image-20220911172647347"></p>
<h5 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h5><blockquote>
<p>有几个注意点：</p>
<p>第一：使用之后分组的货号会被抹去，但找回来也很简单，直接根据索引即可</p>
<p>第二：filter筛选我们所需要的东西，这里是用的销量之和大于6的返回</p>
<p>第三：过滤就相当于删除某些行</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911172922845.png" alt="image-20220911172922845"></p>
<p><img src="/2022/08/20/python+excel/image-20220911174141263.png" alt="image-20220911174141263"></p>
<h6 id="重新加回货号"><a href="#重新加回货号" class="headerlink" title="重新加回货号"></a>重新加回货号</h6><p><img src="/2022/08/20/python+excel/image-20220911174725183.png" alt="image-20220911174725183"></p>
<h3 id="聚合函数-1"><a href="#聚合函数-1" class="headerlink" title="聚合函数"></a>聚合函数</h3><blockquote>
<p>groupby().agg() agg就是聚合的意思。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911175556988.png" alt="image-20220911175556988"></p>
<h4 id="first"><a href="#first" class="headerlink" title="first()"></a>first()</h4><p><img src="/2022/08/20/python+excel/image-20220911175944854.png" alt="image-20220911175944854"></p>
<h4 id="nth"><a href="#nth" class="headerlink" title="nth()"></a>nth()</h4><p><img src="/2022/08/20/python+excel/image-20220911180030022.png" alt="image-20220911180030022"></p>
<h4 id="size"><a href="#size" class="headerlink" title="size()"></a>size()</h4><blockquote>
<p>返回一个series</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911180107952.png" alt="image-20220911180107952"></p>
<h4 id="count"><a href="#count" class="headerlink" title="count()"></a>count()</h4><blockquote>
<p>返回一个dataframe,且所有的列都是货号的个数.</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911180208278.png" alt="image-20220911180208278"></p>
<h3 id="字典传入"><a href="#字典传入" class="headerlink" title="字典传入"></a>字典传入</h3><blockquote>
<p>同样可以配合字典处理</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911181503821.png" alt="image-20220911181503821"></p>
<h3 id="分组条件是否做索引"><a href="#分组条件是否做索引" class="headerlink" title="分组条件是否做索引"></a>分组条件是否做索引</h3><blockquote>
<p>as_index 字面意思。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911181610956.png" alt="image-20220911181610956"></p>
<h3 id="分组后自定义处理"><a href="#分组后自定义处理" class="headerlink" title="分组后自定义处理"></a>分组后自定义处理</h3><blockquote>
<p>理论上可以构建函数处理各种参数</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span>(<span class="params">df, s</span>):</span>        </span><br><span class="line">    <span class="built_in">print</span>(df)        </span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span>        </span><br><span class="line">        df = pd.DataFrame([[<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>], [<span class="string">&#x27;a&#x27;</span>, <span class="number">3</span>]], columns=[<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;age&#x27;</span>])       </span><br><span class="line">        s = <span class="string">&#x27;我是一个被需要的参数&#x27;</span>        </span><br><span class="line">        df.groupby([<span class="string">&#x27;name&#x27;</span>]).<span class="built_in">filter</span>(fun, s=s)  </span><br><span class="line">main() </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  name  age</span><br><span class="line">0    a    1</span><br><span class="line">2    a    3</span><br><span class="line">我是一个被需要的参数</span><br><span class="line">  name  age</span><br><span class="line">1    b    2</span><br><span class="line">我是一个被需要的参数</span><br></pre></td></tr></table></figure>

<h2 id="窗口"><a href="#窗口" class="headerlink" title="窗口"></a>窗口</h2><blockquote>
<p>rolling()</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911203107537.png" alt="image-20220911203107537"></p>
<h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p><img src="/2022/08/20/python+excel/image-20220911202912221.png" alt="image-20220911202912221"></p>
<h3 id="修改最小观测"><a href="#修改最小观测" class="headerlink" title="修改最小观测"></a>修改最小观测</h3><blockquote>
<p>如果不想前两个为空的话，可以利用min_periods参数，指定最小观测范围</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911203016098.png" alt="image-20220911203016098"></p>
<h3 id="修改对齐方式"><a href="#修改对齐方式" class="headerlink" title="修改对齐方式"></a>修改对齐方式</h3><blockquote>
<p>如果希望居中对齐的话。设置：center=True</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911203226452.png" alt="image-20220911203226452"></p>
<h3 id="修改窗口权重"><a href="#修改窗口权重" class="headerlink" title="修改窗口权重"></a>修改窗口权重</h3><blockquote>
<p>win_type()  <a target="_blank" rel="noopener" href="https://blog.csdn.net/chenhepg/article/details/114694133">(19条消息) DataFrame加权滑窗rolling使用，win_type=‘triang‘详解_条件漫步的博客-CSDN博客</a></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911203540162.png" alt="image-20220911203540162"></p>
<h3 id="窗口取值范围"><a href="#窗口取值范围" class="headerlink" title="窗口取值范围"></a>窗口取值范围</h3><blockquote>
<p>offset参数传入2D，他就从当前往前找，直到找完这一天和上一天的</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911204410259.png" alt="image-20220911204410259"></p>
<h3 id="扩展窗口"><a href="#扩展窗口" class="headerlink" title="扩展窗口"></a>扩展窗口</h3><blockquote>
<p>expanding(), 没什么特别，扩展窗口求和而已。 </p>
</blockquote>
<p> <img src="/2022/08/20/python+excel/image-20220911204554027.png" alt="image-20220911204554027"></p>
<p><img src="/2022/08/20/python+excel/image-20220911205204768.png" alt="image-20220911205204768"></p>
<blockquote>
<p>我们用代码来实现这个需求。excel也可以<a target="_blank" rel="noopener" href="https://www.office26.com/excelhanshu/excel_function_13650.html#:~:text=Excel%E7%B4%AF%E8%AE%A1%E6%B1%82%E5%92%8C%E6%8A%80%E5%B7%A7,%E9%80%89%E4%B8%AD%E6%95%B0%E6%8D%AE%E5%8D%95%E5%85%83%E6%A0%BC%EF%BC%8C%E5%9C%A8%E9%80%92%E5%A2%9E%E6%95%B0%E6%8D%AE%E6%B1%82%E5%92%8C%E5%88%97%EF%BC%8C%E6%9C%80%E5%90%8E%E4%B8%80%E8%A1%8C%E8%BE%93%E5%85%A5%E5%85%AC%E5%BC%8F%3DSUM" title="A%241%3A%24A7">excel 递增求和你会吗？excel 递增累计求和技巧_office教程网 (office26.com)</a></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911205333915.png" alt="image-20220911205333915"></p>
<p><img src="/2022/08/20/python+excel/image-20220911205644338.png" alt="image-20220911205644338"></p>
<p><img src="/2022/08/20/python+excel/image-20220911205652996.png" alt="image-20220911205652996"></p>
<h2 id="更多实用函数方法"><a href="#更多实用函数方法" class="headerlink" title="更多实用函数方法"></a>更多实用函数方法</h2><h3 id="将已有列设置为index"><a href="#将已有列设置为index" class="headerlink" title="将已有列设置为index"></a>将已有列设置为index</h3><blockquote>
<p>set_index()</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911205833900.png" alt="image-20220911205833900"></p>
<blockquote>
<p>转化为下图所示</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911205848617.png" alt="image-20220911205848617"></p>
<blockquote>
<p>keys，第一个参数，可以放列名，还可以放个列表啥的，都行都行</p>
<p>drop，默认为True，也就是删除set_index原有的列，将其转移到index上，若为False，结果如下图所示</p>
<p>append，是否将该列名追加于原来的index之后，默认为False，若为True</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911210134125.png" alt="image-20220911210134125"></p>
<p><img src="/2022/08/20/python+excel/image-20220911210249874.png" alt="image-20220911210249874"></p>
<h3 id="转换index为列"><a href="#转换index为列" class="headerlink" title="转换index为列"></a>转换index为列</h3><p><img src="/2022/08/20/python+excel/image-20220911210610278.png" alt="image-20220911210610278"></p>
<p><img src="/2022/08/20/python+excel/image-20220911210642684.png" alt="image-20220911210642684"></p>
<blockquote>
<p>drop即将索引丢弃，level是指你想要设置那一层的索引</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911210835110.png" alt="image-20220911210835110"></p>
<blockquote>
<p>col_level是多少就是说这个新索引的名字出现在列索引的第几层</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911211052817.png" alt="image-20220911211052817"></p>
<h3 id="自定义列名重组"><a href="#自定义列名重组" class="headerlink" title="自定义列名重组"></a>自定义列名重组</h3><blockquote>
<p>​        reindex() 对于下面这个dataframe，他的title为 c b e，不包括a，那么会删除a列，然后将顺序改为c b ，将不存在的e列用NaN补全</p>
<p>主要作用：无论你df以前是什么顺序，我一步就设置成我要得顺序</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911212109454.png" alt="image-20220911212109454"></p>
<p><img src="/2022/08/20/python+excel/image-20220911212224062.png" alt="image-20220911212224062"></p>
<blockquote>
<p>下面代码,index=可写可不写</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911212330419.png" alt="image-20220911212330419"></p>
<p><img src="/2022/08/20/python+excel/image-20220911212607391.png" alt="image-20220911212607391"></p>
<h3 id="像df2一样"><a href="#像df2一样" class="headerlink" title="像df2一样"></a>像df2一样</h3><blockquote>
<p>reindex_like()  </p>
<p>主要作用就是将df1的格式替换为df2的行列格式输出（数据还是用df1的，只抄格式）</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911212813650.png" alt="image-20220911212813650"></p>
<h3 id="重命名索引"><a href="#重命名索引" class="headerlink" title="重命名索引"></a>重命名索引</h3><blockquote>
<p>我认为直接excel改</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911213013112.png" alt="image-20220911213013112"></p>
<blockquote>
<p>也可以传level参数</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911213037396.png" alt="image-20220911213037396"></p>
<h3 id="where条件选择数据"><a href="#where条件选择数据" class="headerlink" title="where条件选择数据"></a>where条件选择数据</h3><blockquote>
<p>pandas.Series.where的返回结果，先用条件筛选，筛选掉的位置用other来填充(<strong>通常选择numpy类型的，舍去这种</strong>)</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911213325245.png" alt="image-20220911213325245"></p>
<blockquote>
<p>numpy的where在这里可以和pandas混合使用。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911213512224.png" alt="image-20220911213512224"></p>
<blockquote>
<p> 现在我们有一个需求，就是搞活动促销，我们想要知道我们实际收款是多少，那么,用where可以轻松解决问题。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911213905760.png" alt="image-20220911213905760"></p>
<p><img src="/2022/08/20/python+excel/image-20220911213825220.png" alt="image-20220911213825220"></p>
<blockquote>
<p>numpy下的where也有他的用武之地，实际工作中使用np.where会更通用，也更常用！！</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220911214119300.png" alt="image-20220911214119300"></p>
<h3 id="根据区间分类"><a href="#根据区间分类" class="headerlink" title="根据区间分类"></a>根据区间分类</h3><blockquote>
<p>注意cut()方法： 左闭右开</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912110326207.png" alt="image-20220912110326207"></p>
<p><img src="/2022/08/20/python+excel/image-20220912110456055.png" alt="image-20220912110456055"></p>
<blockquote>
<p> 参数列表:</p>
<p>x：可以是一个series也可以是一个列表，一定要是<strong>一维</strong>的</p>
<p>bins：箱子的意思，就是箱子是如何分类的，将想要分离的间隔值写入一个列表或者直接写入一个数字，这样的话就等距分隔</p>
<p>include_lowest：将间隔的最小值减去一点点，然后包括最左端的值</p>
<p>right：默认为True，如果是False的话范围取值不包括区间右边的端点，此时如果取False，无需更改include_lowest参数</p>
<p>labels：将你定义的区间，显示数字从区间范围变成你定义的labels</p>
<p>precision：保存的精度，也就是小数点后多少位</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912111204538.png" alt="image-20220912111204538"></p>
<p><img src="/2022/08/20/python+excel/image-20220912111058749.png" alt="image-20220912111058749"></p>
<p><img src="/2022/08/20/python+excel/image-20220912111313530.png" alt="image-20220912111313530"></p>
<h3 id="标记重复值"><a href="#标记重复值" class="headerlink" title="标记重复值"></a>标记重复值</h3><blockquote>
<p>first：第一次出现重复开始，才标记为True，<strong>默认也为first</strong></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912111515968.png" alt="image-20220912111515968"></p>
<blockquote>
<p>last：用倒序，从后开始记录重复</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912111624674.png" alt="image-20220912111624674"></p>
<blockquote>
<p>如果keep=False，那么直接就标记重复的值</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912111704665.png" alt="image-20220912111704665"></p>
<h4 id="丢弃重复值"><a href="#丢弃重复值" class="headerlink" title="丢弃重复值"></a>丢弃重复值</h4><blockquote>
<p>drop_duplicates，这也是为什么参数叫keep的原因，保留第一个，或者保留最后一个，或者都不保留</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912111819912.png" alt="image-20220912111819912"></p>
<blockquote>
<p>dataframe同时观测两列，那么就以两列的数为基准，当两列两列的出现重复才删，例如这里，2、6；2、6</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912112521361.png" alt="image-20220912112521361"></p>
<h3 id="随机取样"><a href="#随机取样" class="headerlink" title="随机取样"></a>随机取样</h3><blockquote>
<p>sample()</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912112903066.png" alt="image-20220912112903066"></p>
<blockquote>
<p>n：就代表取多少个数值</p>
<p>replace：设置是否有放回，默认False（无放回）</p>
<p>frac：取0-1的小数，就是取值个数占所有数的比例，例如总共五个数，传入0.8，则返回4个数。</p>
<p>weight：取到每个数的权重概率，这个就是传入一个有n个数字的列表就行，他会自动把列表进行归一化，总之就是取值越大，越有可能获得，当然，手动归一到0-1之间，会更加直观</p>
<p>random_state=xxx           设置随机种子，也就是把每次的结果固定下来</p>
<p>axis：主要针对于dataframe，如果是0，则取xxx行，如果是1，则取xxx列，也就是随机抽取</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912113351626.png" alt="image-20220912113351626"></p>
<p><img src="/2022/08/20/python+excel/image-20220912113724644.png" alt="image-20220912113724644"></p>
<h3 id="重新采样"><a href="#重新采样" class="headerlink" title="重新采样"></a>重新采样</h3><blockquote>
<p>resample</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912113953886.png" alt="image-20220912113953886"></p>
<p><img src="/2022/08/20/python+excel/image-20220912115904464.png" alt="image-20220912115904464"></p>
<blockquote>
<p>为每一个时间戳生成一个1-6的随机数，然后用重采样对他进行处理！</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912114203329.png" alt="image-20220912114203329"></p>
<h4 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h4><blockquote>
<p>例如对这张表的数据进行重采样统计</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912114649736.png" alt="image-20220912114649736"></p>
<blockquote>
<p>通过重采样，并且sum求和函数，将所有数值类型的量进行统计</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912114803387.png" alt="image-20220912114803387"></p>
<blockquote>
<p>同时，当然也可以对其进行字典分组操作.agg</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912114946680.png" alt="image-20220912114946680"></p>
<blockquote>
<p>将日期列定义为时间类型，但不定义为索引，我们也可以通过on参数来进行指定重采样的索引</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912115323630.png" alt="image-20220912115323630"></p>
<h3 id="apply-应用函数"><a href="#apply-应用函数" class="headerlink" title="apply()应用函数"></a>apply()应用函数</h3><blockquote>
<p>我们着重讲Series.apply()，其实这些都可以调用，只不过逻辑一样</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912150131933.png" alt="image-20220912150131933"></p>
<blockquote>
<p>apply可以代替聚合和转换功能</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912150252120.png" alt="image-20220912150252120"></p>
<blockquote>
<p>传入参数为函数</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912150349527.png" alt="image-20220912150349527"></p>
<blockquote>
<p>运用过程</p>
</blockquote>
<h4 id="传入python-func"><a href="#传入python-func" class="headerlink" title="传入python func"></a>传入python func</h4><p><img src="/2022/08/20/python+excel/image-20220912150427791.png" alt="image-20220912150427791"></p>
<blockquote>
<p>所以我们就可以知道传入一个python函数，他会对series的参数进行逐个传入。</p>
<p>args：传入额外的参数</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912150722224.png" alt="image-20220912150722224"></p>
<p><img src="/2022/08/20/python+excel/image-20220912151332726.png" alt="image-20220912151332726"></p>
<blockquote>
<p>也可以直接用y=，z=，这样更直观一点</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912151444194.png" alt="image-20220912151444194"></p>
<blockquote>
<p>axis=0时，设置垂直计算</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912151555245.png" alt="image-20220912151555245"></p>
<blockquote>
<p>以下是apply调用numpy函数的演示</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912150531368.png" alt="image-20220912150531368"></p>
<blockquote>
<p>另外，’sum’代表传 入一个numpy方法，如果直接sum的话叫做传入了一个python的内置函数，会引发报错，报错内容就是说int不是一个可迭代参数</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912151029606.png" alt="image-20220912151029606"></p>
<h3 id="排名"><a href="#排名" class="headerlink" title="排名"></a>排名</h3><blockquote>
<p>rank()</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912151750888.png" alt="image-20220912151750888"></p>
<blockquote>
<p>以下是对series([7, 8, 8, 8, 9])的各种排名操作，方法默认使用average，我们实际用dense和first居多</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912151931539.png" alt="image-20220912151931539"></p>
<blockquote>
<p> 参数列表：</p>
<p>method：选择方法</p>
<p>ascending:  默认升序，改成False可以为降序</p>
<p>numeric_only：只对数字类型进行排序</p>
<p>na_option：对空值的处理办法默认是<code>&#39;keep&#39;</code>有{‘keep’, ‘top’, ‘bottom’}   top bottom就是指把空值的排名定位于第一还是倒数第一</p>
<p>pct：百分位的排名</p>
<p>ps：若排序结果为浮点型，用convert_dtypes()可以改变为整型</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912152120429.png" alt="image-20220912152120429"></p>
<blockquote>
<p>dataframe演示，实现先对id进行分组，然后对value列进行排名</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912153218478.png" alt="image-20220912153218478"></p>
<h3 id="堆叠"><a href="#堆叠" class="headerlink" title="堆叠"></a>堆叠</h3><h4 id="列索引堆叠于行索引"><a href="#列索引堆叠于行索引" class="headerlink" title="列索引堆叠于行索引"></a>列索引堆叠于行索引</h4><blockquote>
<p>stack() 把列索引堆叠到行索引列</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912153354867.png" alt="image-20220912153354867"></p>
<blockquote>
<p>参数列表：</p>
<p>dropna：默认为True，就是丢掉数据里的空值</p>
<p>level=-1，默认为是列索引最下面那一层，0就是倒数第二下面的，在这里，-1就是i、j</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912153447873.png" alt="image-20220912153447873"></p>
<p><img src="/2022/08/20/python+excel/image-20220912153720564.png" alt="image-20220912153720564"></p>
<h4 id="行索引反堆叠于列索引"><a href="#行索引反堆叠于列索引" class="headerlink" title="行索引反堆叠于列索引"></a>行索引反堆叠于列索引</h4><blockquote>
<p>unstack() 反堆叠 （index -&gt; columns)</p>
<p>和我们想的也一样，level = 0这一层要外面一点。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912154029325.png" alt="image-20220912154029325"></p>
<h3 id="max-min"><a href="#max-min" class="headerlink" title="max/min"></a>max/min</h3><h4 id="idxmax-min"><a href="#idxmax-min" class="headerlink" title="idxmax/min"></a>idxmax/min</h4><blockquote>
<p>idx，依照id来顺序访问，找到第一个idx的最大值/最小值</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912154257045.png" alt="image-20220912154257045"></p>
<p><img src="/2022/08/20/python+excel/image-20220912154326701.png" alt="image-20220912154326701"></p>
<h4 id="argmax-min"><a href="#argmax-min" class="headerlink" title="argmax/min"></a>argmax/min</h4><blockquote>
<p>arg找的是数字索引，所以会返回<code>2</code>和<code>1</code></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912154353919.png" alt="image-20220912154353919"></p>
<p><img src="/2022/08/20/python+excel/image-20220912154433075.png" alt="image-20220912154433075"></p>
<h4 id="nlargest-nsmallest"><a href="#nlargest-nsmallest" class="headerlink" title="nlargest/nsmallest"></a>nlargest/nsmallest</h4><blockquote>
<p>nlargest(1)    nsmallest(1)、返回的是series</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912154612070.png" alt="image-20220912154612070"></p>
<p><img src="/2022/08/20/python+excel/image-20220912154636655.png" alt="image-20220912154636655"></p>
<p><img src="/2022/08/20/python+excel/image-20220912154839918.png" alt="image-20220912154839918"></p>
<h3 id="查询并筛选行"><a href="#查询并筛选行" class="headerlink" title="查询并筛选行"></a>查询并筛选行</h3><blockquote>
<p>query() ，他的好处是可以链式查询</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912155256885.png" alt="image-20220912155256885"></p>
<blockquote>
<p>但当列表名为c c，我们需要特殊处理就是加    <strong>`c c`</strong></p>
<p>还有就是如果要传入外部变量，需要在布尔表达式中，该变量前加  <strong>@</strong></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912155422221.png" alt="image-20220912155422221"></p>
<h3 id="列名转化为数据"><a href="#列名转化为数据" class="headerlink" title="列名转化为数据"></a>列名转化为数据</h3><blockquote>
<p>melt()             逆透视</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912155549610.png" alt="image-20220912155549610"></p>
<blockquote>
<p>参数列表：</p>
<p>逆透视中只有value和variable，分别是变量和参数的意思</p>
<p>id_vars：就是选择不改变格式的列，也就是输出的结果，该选中列不会发生改变，充当索引，填入列名或者列表的列名</p>
<p>value_vars：选取xx列的变量，填入列名或者列表的列名</p>
<p>用var_name和value_name就是重命名列名，好理解。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912155620795.png" alt="image-20220912155620795"></p>
<p><img src="/2022/08/20/python+excel/image-20220912160218396.png" alt="image-20220912160218396"></p>
<h3 id="错位相减"><a href="#错位相减" class="headerlink" title="错位相减"></a>错位相减</h3><blockquote>
<p>diff()  传入的数字为偏移量，默认为1，也可以传入<strong>负值</strong>，就换成向上移动</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912160452732.png" alt="image-20220912160452732"></p>
<blockquote>
<p>dataframe也是一样的 </p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912160636229.png" alt="image-20220912160636229"></p>
<h3 id="偏移数据-时间索引"><a href="#偏移数据-时间索引" class="headerlink" title="偏移数据/时间索引"></a>偏移数据/时间索引</h3><blockquote>
<p>shift() </p>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">##### Series/DataFrame/GroupBy</span></span><br><span class="line"><span class="section">##### shift() 偏移数据, 偏移时间索引</span></span><br><span class="line"><span class="bullet">-</span> periods: 指定偏移量（偏移位数，可为负数）</span><br><span class="line"><span class="bullet">-</span> fill<span class="emphasis">_value: 填充空值</span></span><br><span class="line"><span class="emphasis">- freq: 指定为偏移时间索引</span></span><br><span class="line"><span class="emphasis">1. &quot;D&quot;, &quot;W&quot;, &quot;M&quot;, &quot;infer&quot;</span></span><br><span class="line"><span class="emphasis">2. DateOffset, BDay, Timedelta</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>freq与periods混合使用效果更佳哦</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912161244496.png" alt="image-20220912161244496"></p>
<blockquote>
<p>BDay就是说偏移之后的结果都不会包括周六和周日</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912161701351.png" alt="image-20220912161701351"></p>
<h3 id="百分比变化情况"><a href="#百分比变化情况" class="headerlink" title="百分比变化情况"></a>百分比变化情况</h3><blockquote>
<p>Series/DataFrame/GroupBy</p>
<p>pct_change() (Percentage change) 百分比变化</p>
<ul>
<li><p>periods: 偏移量 （例如原来该第二个减第一个的，你设置periods为2，则是第三个开始，减去第一个)</p>
</li>
<li><p>freq: 频率(时间索引)</p>
<ol>
<li>“D”, “W”, “M”, “MS”, “B”</li>
<li>DateOffset, Timedelta</li>
</ol>
</li>
<li><p>limit: 最多连续填充空值个数</p>
</li>
</ul>
</blockquote>
<blockquote>
<p>这个是怎么计算的呢？，（2 - 1）/ 1 = 1          (3 - 2) / 2 = 0.5    所以这一列就相当于原始的数据源百分比的增长情况</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912162100495.png" alt="image-20220912162100495"></p>
<blockquote>
<p>limit用法，limit设置为1，他只从上到下填充了一个空值</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912162543153.png" alt="image-20220912162543153"></p>
<p><img src="/2022/08/20/python+excel/image-20220912162744521.png" alt="image-20220912162744521"></p>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><blockquote>
<p>update()</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912163147168.png" alt="image-20220912163147168"></p>
<blockquote>
<p>简单说就是替换！用右边的数字来替换左边的数字，是就地修改</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912163234607.png" alt="image-20220912163234607"></p>
<blockquote>
<p>不过，如果右边的表内，该位置数字为空，那么左表保持不变</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912163416404.png" alt="image-20220912163416404"></p>
<blockquote>
<p>如果需要用series修改dataframe的值，那么需要设置name和index，不然无法对应到位置</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912163529247.png" alt="image-20220912163529247"></p>
<h2 id="数据可视化"><a href="#数据可视化" class="headerlink" title="数据可视化"></a>数据可视化</h2><h3 id="支持图的种类"><a href="#支持图的种类" class="headerlink" title="支持图的种类"></a>支持图的种类</h3><blockquote>
<p>问号快速查看帮助文档</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912170123636.png" alt="image-20220912170123636"></p>
<p><img src="/2022/08/20/python+excel/image-20220912170145953.png" alt="image-20220912170145953"></p>
<p><strong>line</strong>：直线图</p>
<p><img src="/2022/08/20/python+excel/image-20220912170243496.png" alt="image-20220912170243496"></p>
<p><strong>bar</strong>：条形图</p>
<p><img src="/2022/08/20/python+excel/image-20220912170324667.png" alt="image-20220912170324667"></p>
<p><strong>barh</strong>：水平条形图</p>
<p><img src="/2022/08/20/python+excel/image-20220912170401531.png" alt="image-20220912170401531"></p>
<p><strong>pie</strong>：饼图</p>
<blockquote>
<p>如果series有一个名字，None就会显示他的名字</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912170423081.png" alt="image-20220912170423081"></p>
<p><strong>scatter</strong>：散点图</p>
<p><img src="/2022/08/20/python+excel/image-20220912170513010.png" alt="image-20220912170513010"></p>
<p><strong>hexbin</strong>：六角箱图</p>
<blockquote>
<p>颜色越深的地方，六角箱图包含的个数就越多</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912170554339.png" alt="image-20220912170554339"></p>
<p><strong>hist</strong>：直方图</p>
<blockquote>
<p>某个区间的数值所出现的频率</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912170657042.png" alt="image-20220912170657042"></p>
<p><strong>kde</strong>：密度图</p>
<blockquote>
<p>randn是符合正态分布的，rand不是</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912170745390.png" alt="image-20220912170745390"></p>
<blockquote>
<p>如果求落在某一区间的概率，那么可以转化为求他的面积，因为总面积一定为1</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912170842367.png" alt="image-20220912170842367"></p>
<blockquote>
<p>密度图与直方图的比较</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912171006870.png" alt="image-20220912171006870"></p>
<p><strong>box</strong>：箱型图</p>
<blockquote>
<p>注意是rand</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912171236525.png" alt="image-20220912171236525"></p>
<blockquote>
<p>如果有一个点，超过了箱子的2.5倍，自身+自身的1.5倍，那么、就称呼这个点为异常点</p>
<p>另外图上绿色线那里，就是数据最多的位置</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912171342829.png" alt="image-20220912171342829"></p>
<p><strong>area</strong>：面积图</p>
<p><img src="/2022/08/20/python+excel/image-20220912171517112.png" alt="image-20220912171517112"></p>
<h3 id="matplotlib-pyplot"><a href="#matplotlib-pyplot" class="headerlink" title="matplotlib.pyplot()"></a>matplotlib.pyplot()</h3><blockquote>
<p>通常绘图都是在Axes（坐标系）来绘制的，一个Figure可以包括多个Axes，Axes是Axis的复数哦</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912171846112.png" alt="image-20220912171846112"></p>
<h4 id="准备阶段"><a href="#准备阶段" class="headerlink" title="准备阶段"></a>准备阶段</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.style.use(<span class="string">&#x27;seaborn-white&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/20/python+excel/image-20220912172115236.png" alt="image-20220912172115236"></p>
<h4 id="figure"><a href="#figure" class="headerlink" title="figure()"></a>figure()</h4><blockquote>
<p>参数列表：</p>
<p>facecolor，边框的颜色风格</p>
<p>figsize:默认6 * 4（600 * 400），可以调整尺寸</p>
<p>dpi:越大越清晰</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912172241570.png" alt="image-20220912172241570"></p>
<h3 id="pyplot-style"><a href="#pyplot-style" class="headerlink" title="pyplot-style"></a>pyplot-style</h3><p><strong>实际使用时建议风格二选一</strong></p>
<blockquote>
<p>还有一些值得注意的参数：</p>
<p>title：标题而已啦</p>
<p>ylabel，xlabel：设置x、y轴索引 可传入参数fontsize设置字体大小，color设置颜色等等，具体就到时候再搜，有一个以前一直不知道的可以设置的参数，将y轴转正，为<code>rotation=0</code>,还有将这个label往外往里移动的，labelpad</p>
<p>xlim，ylim：限制x、y轴取值，传入列表，输入左右两端的值即可</p>
<p>xticks：同样传入列表，具体见下图</p>
<p>grid：是否使用网格</p>
<p>legend：显示每个plt的标签 一个参数 loc=  就是legend的位置，默认是自动选取最好位置</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912173052960.png" alt="image-20220912173052960"></p>
<blockquote>
<p>gca：获取当前坐标系，下面这种调用形式设置主次刻度</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912173248085.png" alt="image-20220912173248085"></p>
<h3 id="OO-style"><a href="#OO-style" class="headerlink" title="OO-style"></a>OO-style</h3><p>其实大部分情况就是把plt.xxxx调用换成面向对象获取到的轴来调用，这里的话就是用ax.xxxxxx</p>
<p><img src="/2022/08/20/python+excel/image-20220912173516159.png" alt="image-20220912173516159"></p>
<p><img src="/2022/08/20/python+excel/image-20220912173605098.png" alt="image-20220912173605098"></p>
<h3 id="绘制多图"><a href="#绘制多图" class="headerlink" title="绘制多图"></a>绘制多图</h3><p><img src="/2022/08/20/python+excel/image-20220912173751343.png" alt="image-20220912173751343"></p>
<blockquote>
<p>一般来说，下面这种绘图方法，使用面向对象，不适用plt</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912173956841.png" alt="image-20220912173956841"></p>
<blockquote>
<p>tight_layout()使得均匀分布，不会让大小与其他图碰上</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912174011918.png" alt="image-20220912174011918"></p>
<h4 id="面向对象的形式"><a href="#面向对象的形式" class="headerlink" title="面向对象的形式"></a>面向对象的形式</h4><p><img src="/2022/08/20/python+excel/image-20220912174303275.png" alt="image-20220912174303275"></p>
<blockquote>
<p>nrows、ncols，多少行列的大图（每一行，每一列，都有几个小图）。</p>
<p>sharex和sharey，是否共享x/y轴。</p>
<p>facecolor：背景白色。</p>
<p>figsize：大图的尺寸 例如10 * 8（1000 * 800）</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912174707204.png" alt="image-20220912174707204"></p>
<p><img src="/2022/08/20/python+excel/image-20220912174805271.png" alt="image-20220912174805271"></p>
<h3 id="rcParams全局参数"><a href="#rcParams全局参数" class="headerlink" title="rcParams全局参数"></a>rcParams全局参数</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://matplotlib.org/stable/tutorials/introductory/customizing.html#matplotlibrc-sample">Customizing Matplotlib with style sheets and rcParams — Matplotlib 3.5.3 documentation</a>这里是可以设置的参数</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912194536784.png" alt="image-20220912194536784"></p>
<h3 id="colormaps"><a href="#colormaps" class="headerlink" title="colormaps"></a>colormaps</h3><blockquote>
<p> colormaps，cmap，cm：颜色表</p>
<p># <a target="_blank" rel="noopener" href="https://matplotlib.org/examples/color/colormaps_reference.html%E9%A2%9C%E8%89%B2%E5%A4%A7%E5%85%A8,%E4%BD%BF%E7%94%A8%E9%87%8C%E9%9D%A2%E7%9A%84%E5%90%8D%E5%AD%97%E4%BC%A0%E5%85%A5%E5%B0%B1%E8%A1%8C![image-20220912195332370](python+excel/image-20220912195332370.png)">https://matplotlib.org/examples/color/colormaps_reference.html颜色大全,使用里面的名字传入就行![image-20220912195332370](python+excel/image-20220912195332370.png)</a></p>
<p><code>available</code>显示他的可选参数</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912195154471.png" alt="image-20220912195154471"></p>
<p><img src="/2022/08/20/python+excel/image-20220912195409589.png" alt="image-20220912195409589"></p>
<blockquote>
<p>也可自定义colormap</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912195442276.png" alt="image-20220912195442276"></p>
<h3 id="设置颜色、线条、点样式"><a href="#设置颜色、线条、点样式" class="headerlink" title="设置颜色、线条、点样式"></a>设置颜色、线条、点样式</h3><h4 id="color"><a href="#color" class="headerlink" title="color"></a>color</h4><p><img src="/2022/08/20/python+excel/image-20220912195539213.png" alt="image-20220912195539213"></p>
<p><img src="/2022/08/20/python+excel/image-20220912195605915.png" alt="image-20220912195605915"></p>
<p><img src="/2022/08/20/python+excel/image-20220912195620323.png" alt="image-20220912195620323"></p>
<p><img src="/2022/08/20/python+excel/image-20220912195638748.png" alt="image-20220912195638748"></p>
<p><img src="/2022/08/20/python+excel/image-20220912195646682.png" alt="image-20220912195646682"></p>
<h4 id="marker"><a href="#marker" class="headerlink" title="marker"></a>marker</h4><p><img src="/2022/08/20/python+excel/image-20220912195708420.png" alt="image-20220912195708420"></p>
<h4 id="line"><a href="#line" class="headerlink" title="line"></a>line</h4><p><img src="/2022/08/20/python+excel/image-20220912195745021.png" alt="image-20220912195745021"></p>
<h3 id="seaborn"><a href="#seaborn" class="headerlink" title="seaborn"></a>seaborn</h3><blockquote>
<p><a target="_blank" rel="noopener" href="http://seaborn.pydata.org/">seaborn: statistical data visualization — seaborn 0.12.0 documentation (pydata.org)</a></p>
</blockquote>
<blockquote>
<p> seaborn多图绘制<a target="_blank" rel="noopener" href="https://www.cnblogs.com/chenhuabin/p/15925949.html">seaborn学习笔记（五）：绘制多子图 - 奥辰 - 博客园 (cnblogs.com)</a></p>
</blockquote>
<h4 id="load-dataset"><a href="#load-dataset" class="headerlink" title="load_dataset()"></a>load_dataset()</h4><blockquote>
<p>默认有一些可供练手的数据集</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912200216512.png" alt="image-20220912200216512"></p>
<h4 id="set"><a href="#set" class="headerlink" title="set()"></a>set()</h4><blockquote>
<p>这是默认画出来的图的风格</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912201327073.png" alt="image-20220912201327073"></p>
<blockquote>
<p>我们在画图之前set一下，会输出seaborn默认的风格和参数</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912201407118.png" alt="image-20220912201407118"></p>
<p><img src="/2022/08/20/python+excel/image-20220912201734465.png" alt="image-20220912201734465"></p>
<blockquote>
<p>context可选值仅有{paper, notebook, talk, poster} 主要改变的是x，y轴字体的比例，他们的比例是**{0.8 1 1.3 1.6}<strong>，不过通常用</strong>font_scale**=1.6这样直接替代比较直观</p>
<p>style： {darkgrid，whitegrid，dark，white，ticks}</p>
<p>palette(调色板）：推荐使用<strong>muted</strong><img src="/2022/08/20/python+excel/image-20220912202122305.png" alt="image-20220912202122305"></p>
<p>rc：可以覆盖以上所有，所以肯定不会用，没这需求</p>
</blockquote>
<h4 id="seaborn图例关系"><a href="#seaborn图例关系" class="headerlink" title="seaborn图例关系"></a>seaborn图例关系</h4><p><img src="/2022/08/20/python+excel/image-20220912202613757.png" alt="image-20220912202613757"></p>
<h5 id="关系图"><a href="#关系图" class="headerlink" title="关系图"></a>关系图</h5><p><img src="/2022/08/20/python+excel/image-20220912202807108.png" alt="image-20220912202807108"></p>
<h5 id="分类图"><a href="#分类图" class="headerlink" title="分类图"></a>分类图</h5><h6 id="散点"><a href="#散点" class="headerlink" title="散点"></a>散点</h6><blockquote>
<p>大同小异，左边加了一些随机抖动，右边绝对不会重叠</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912202901008.png" alt="image-20220912202901008"></p>
<h6 id="分布"><a href="#分布" class="headerlink" title="分布"></a>分布</h6><blockquote>
<p>超过上界和下界的都可以看做离群点，小提琴图可以看做是密度图和箱型图结合在一起</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912203032442.png" alt="image-20220912203032442"></p>
<h6 id="估计"><a href="#估计" class="headerlink" title="估计"></a>估计</h6><blockquote>
<p>箱型图的那条线，表示的是一个置信区间，就是有95的概率落在这条线内(可以自定义)，中间这个图，长方形最上端表示的是这个数据的均值位置，右边那个图，是指数量的累加，自然就无均值的意思</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912203324816.png" alt="image-20220912203324816"></p>
<h5 id="分布图"><a href="#分布图" class="headerlink" title="分布图"></a>分布图</h5><blockquote>
<p>双变量多出来的那两块可以指定为直方图，也可以指定为密度图</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912203515282.png" alt="image-20220912203515282"></p>
<h5 id="重点"><a href="#重点" class="headerlink" title="重点"></a>重点</h5><p><img src="/2022/08/20/python+excel/image-20220912203612646.png" alt="image-20220912203612646"></p>
<h4 id="Olympic实战"><a href="#Olympic实战" class="headerlink" title="Olympic实战"></a>Olympic实战</h4><blockquote>
<p>数据集介绍</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912204731017.png" alt="image-20220912204731017"></p>
<p><img src="/2022/08/20/python+excel/image-20220912204814740.png" alt="image-20220912204814740"></p>
<h5 id="合并检查数据"><a href="#合并检查数据" class="headerlink" title="合并检查数据"></a>合并检查数据</h5><blockquote>
<p>我们合并两表，并且发现数据集height和weight比起别的少了许多，又因为基数很大，所以把缺少的地方都删掉，并将其存放于一个变量</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912205212879.png" alt="image-20220912205212879"></p>
<blockquote>
<p>删除完毕后</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912205343926.png" alt="image-20220912205343926"></p>
<h5 id="散点图绘制"><a href="#散点图绘制" class="headerlink" title="散点图绘制"></a>散点图绘制</h5><blockquote>
<p>scatter进行绘图，发现数量太过于庞大</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912205513137.png" alt="image-20220912205513137"></p>
<blockquote>
<p>进行筛选，仅显示CHN，RUS，USA，并且年大于2008，并对运动员进行去重<img src="/2022/08/20/python+excel/image-20220912205640469.png" alt="image-20220912205640469"></p>
<p>这样还是有6000多个点（没去重成功），最后再随机采样30个点，这样的话点数就会很少了</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912205748364.png" alt="image-20220912205748364"></p>
<blockquote>
<p>最重要的一个参数是hue，语义的意思、颜色的语义，帮助我们分类，style，风格的意思，也帮助我们分类，区分点的类型，还有一个是size,使用一个数值来表示它的大小</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912205854365.png" alt="image-20220912205854365"></p>
<p><img src="/2022/08/20/python+excel/image-20220912210001237.png" alt="image-20220912210001237"></p>
<p><img src="/2022/08/20/python+excel/image-20220912210033307.png" alt="image-20220912210033307"></p>
<blockquote>
<p>所以说一个表格最多可以传入<strong>五维</strong>的关系</p>
</blockquote>
<blockquote>
<p>如果我们换用relation图，然后kind设置为scatter，然后增加一个参数 <strong>col</strong> 甚至还可以增加一个维度！！！</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912210309678.png" alt="image-20220912210309678"></p>
<blockquote>
<p>传入<strong>aspect</strong>，这个是设置轴的长宽比，这里设置为3：2，也可以设置整个图高度<strong>height</strong>，每一个高度代表72个像素</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912210622352.png" alt="image-20220912210622352"></p>
<blockquote>
<p>对于语义参数，我们优先选用hue，因为style和size看上去没有hue那么明显。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912210846495.png" alt="image-20220912210846495"></p>
<blockquote>
<p>最后是一些花里胡哨的演示</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;whitegrid&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the example diamonds dataset</span></span><br><span class="line">diamonds = sns.load_dataset(<span class="string">&quot;diamonds&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Draw a scatter plot while assigning point colors and sizes to different</span></span><br><span class="line"><span class="comment"># variables in the dataset</span></span><br><span class="line">f, ax = plt.subplots(figsize=(<span class="number">6.5</span>, <span class="number">6.5</span>))</span><br><span class="line"><span class="comment"># despine()函数移除坐标轴</span></span><br><span class="line">sns.despine(f, left=<span class="literal">True</span>, bottom=<span class="literal">True</span>)		<span class="comment">#默认舍弃了上右的坐标轴，这里参数为True，也舍弃了下左的坐标轴</span></span><br><span class="line">clarity_ranking = [<span class="string">&quot;I1&quot;</span>, <span class="string">&quot;SI2&quot;</span>, <span class="string">&quot;SI1&quot;</span>, <span class="string">&quot;VS2&quot;</span>, <span class="string">&quot;VS1&quot;</span>, <span class="string">&quot;VVS2&quot;</span>, <span class="string">&quot;VVS1&quot;</span>, <span class="string">&quot;IF&quot;</span>]</span><br><span class="line">sns.scatterplot(x=<span class="string">&quot;carat&quot;</span>, y=<span class="string">&quot;price&quot;</span>,</span><br><span class="line">                hue=<span class="string">&quot;clarity&quot;</span>, size=<span class="string">&quot;depth&quot;</span>,</span><br><span class="line">                palette=<span class="string">&quot;ch:r=-.2,d=.3_r&quot;</span>,</span><br><span class="line">                hue_order=clarity_ranking,</span><br><span class="line">                sizes=(<span class="number">1</span>, <span class="number">8</span>), linewidth=<span class="number">0</span>,</span><br><span class="line">                data=diamonds, ax=ax)</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/20/python+excel/image-20220913094033185.png" alt="image-20220913094033185"></p>
<h5 id="线图"><a href="#线图" class="headerlink" title="线图"></a>线图</h5><blockquote>
<p>line：线图强调连续性，通常是时间的连续。也就是x是年，y是一个数值类型</p>
</blockquote>
<blockquote>
<p>最简单的画法演示，最外面浅色的是属于置信区间，实线就是平均升高</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912211539871.png" alt="image-20220912211539871"></p>
<blockquote>
<p>下图体现出他是分组求均值再进行排序，并且如果数据出现空值，会双双删掉</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912211942829.png" alt="image-20220912211942829"></p>
<blockquote>
<p>我们观察上上图，最后出现了锯齿状，是因为冬季夏季奥运会的缘故，因此用hue进行作图</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912212119410.png" alt="image-20220912212119410"></p>
<blockquote>
<p>如果用relplot，可以使得图例跑到外面去，从而更加美观（另外新增了sex）</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912212239617.png" alt="image-20220912212239617"></p>
<h5 id="条形图"><a href="#条形图" class="headerlink" title="条形图"></a>条形图</h5><blockquote>
<p>两种方式均可</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912213824279.png" alt="image-20220912213824279"></p>
<p><img src="/2022/08/20/python+excel/image-20220912214048918.png" alt="image-20220912214048918"></p>
<blockquote>
<p>这个小点是置信区间，也可关掉，ci=False<br>另外order可以进行参数之间的排序</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912214201802.png" alt="image-20220912214201802"></p>
<h5 id="数量条形图"><a href="#数量条形图" class="headerlink" title="数量条形图"></a>数量条形图</h5><blockquote>
<p>这次我们对奖牌数量进行处理，用奖牌和年龄段进行分析，首先删掉所有None（没获奖的)，转换类型，将奖牌对年龄进行排序，然后把x轴转换90度</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912214716158.png" alt="image-20220912214716158"></p>
<p><img src="/2022/08/20/python+excel/image-20220912214806380.png" alt="image-20220912214806380"></p>
<blockquote>
<p>所以可以看到运动员职业生涯的巅峰就在二十三二十四左右</p>
</blockquote>
<blockquote>
<p>选取拿金牌的人</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912215025433.png" alt="image-20220912215025433"></p>
<blockquote>
<p>分析国家拿奖牌的情况，我们先进行去重，也就是对同一届奥运会，同一个事件，同一个奖牌，只保留一个，且只取1984年以后的数据来进行对比</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912215225370.png" alt="image-20220912215225370"></p>
<p><img src="/2022/08/20/python+excel/image-20220912215321234.png" alt="image-20220912215321234"></p>
<blockquote>
<p>排序中国和美国的奖牌数</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912215604731.png" alt="image-20220912215604731"></p>
<blockquote>
<p>08年奖牌数</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912215725766.png" alt="image-20220912215725766"></p>
<blockquote>
<p>我国奖牌数</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912215825788.png" alt="image-20220912215825788"></p>
<blockquote>
<p>使用catplot展示</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912215927336.png" alt="image-20220912215927336"></p>
<h5 id="箱型图"><a href="#箱型图" class="headerlink" title="箱型图"></a>箱型图</h5><p><img src="/2022/08/20/python+excel/image-20220912220314846.png" alt="image-20220912220314846"></p>
<blockquote>
<p>首先用5个例子国家，和中国，定义出一个df，然后用这个df来演示箱型图，箱型图是适合于四分位的图，年龄，升高，体重都可以</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912220439075.png" alt="image-20220912220439075"></p>
<blockquote>
<p>分析运动员年龄</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912220547035.png" alt="image-20220912220547035"></p>
<blockquote>
<p>   分析运动员身高，横过来就是xy数据交换就可以了</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912220740539.png" alt="image-20220912220740539"></p>
<h5 id="密度图"><a href="#密度图" class="headerlink" title="密度图"></a>密度图</h5><p><img src="/2022/08/20/python+excel/image-20220912220903793.png" alt="image-20220912220903793"></p>
<blockquote>
<p>阴影shade设置为True就会有浅色阴影 ，普遍传入的是一维的数据，默认这样正着，如果你想把它倒着，那么有个参数vertical，设置为True即可</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912221035655.png" alt="image-20220912221035655"></p>
<h5 id="小提琴图"><a href="#小提琴图" class="headerlink" title="*小提琴图"></a>*小提琴图</h5><p><img src="/2022/08/20/python+excel/image-20220912221202799.png" alt="image-20220912221202799"></p>
<blockquote>
<p>操作全跟箱型图一样即可，就当箱型图用</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912221313057.png" alt="image-20220912221313057"></p>
<h5 id="分布图-1"><a href="#分布图-1" class="headerlink" title="*分布图"></a>*分布图</h5><blockquote>
<p>之前讲过的KDE也是分布图</p>
<p>参数主要使用前五个</p>
<p>a：一维列表或者series</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912221415608.png" alt="image-20220912221415608"></p>
<p><img src="/2022/08/20/python+excel/image-20220912221607600.png" alt="image-20220912221607600"></p>
<blockquote>
<p>bins控制条的数量</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912221841883.png" alt="image-20220912221841883"></p>
<blockquote>
<p>bins可以参考官方文档，可以设置为int或者字符串，字符串就是一些设置好的分箱策略，估计用不上吧，一般默认即可。</p>
</blockquote>
<h4 id="figure-level-和-axes-level"><a href="#figure-level-和-axes-level" class="headerlink" title="figure-level 和 axes-level"></a>figure-level 和 axes-level</h4><blockquote>
<p>一个面下面可以有多个轴，下面的函数都是可以在上面的函数上运行的</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912212502363.png" alt="image-20220912212502363"></p>
<h5 id="FacetGrid-方法"><a href="#FacetGrid-方法" class="headerlink" title="FacetGrid 方法"></a>FacetGrid 方法</h5><ul>
<li>facet_axis(row_i, col_j): 获取指定轴</li>
<li>set(<br>  xlim,<br>  ylim,<br>  xlabel,<br>  xticklabels,<br>  ylabel,<br>  yticklabels<br>  title):           在每个子图轴上设置属性</li>
<li>set_axis_labels():  设置轴标签</li>
<li>set_titles():       绘制标题</li>
<li>set_xlabels():      x轴标签</li>
<li>set_xticklabels():  x轴刻度标签</li>
<li>set_ylabels():      y轴标签</li>
<li>set_yticklabels():  y轴刻度标签<h5 id="FacetGrid-属性"><a href="#FacetGrid-属性" class="headerlink" title="FacetGrid 属性"></a>FacetGrid 属性</h5></li>
<li>ax:   单轴</li>
<li>axes: 多轴(axes.flat)</li>
</ul>
<h5 id="演示"><a href="#演示" class="headerlink" title="演示"></a>演示</h5><blockquote>
<p>g 也就是seaborn下面的一个类。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912212851653.png" alt="image-20220912212851653"></p>
<blockquote>
<p>直接用lineplot画，比例会有一些不同，不过返回值就是完全不一样的。</p>
<p>另外，<strong>ci=None</strong> 关闭置信区间</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912212954139.png" alt="image-20220912212954139"></p>
<blockquote>
<p>但如果我们对g进行一次g.ax操作，那么返回的就是那个轴</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912213112141.png" alt="image-20220912213112141"></p>
<blockquote>
<p>取到子轴的办法</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912213336632.png" alt="image-20220912213336632"></p>
<blockquote>
<p>设置<strong>标题</strong>和<strong>label</strong></p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912213530766.png" alt="image-20220912213530766"></p>
<blockquote>
<p>将轴传给自己，他将会继续在这个轴进行画图</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912213633633.png" alt="image-20220912213633633"></p>
<h4 id="点图"><a href="#点图" class="headerlink" title="点图"></a>点图</h4><blockquote>
<p>使用tips展示，bar，line，point三合一展示</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912220132389.png" alt="image-20220912220132389"></p>
<blockquote>
<p>加入了躲避dodge和置信区间ci</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912220213016.png" alt="image-20220912220213016"></p>
<blockquote>
<p>也可以选择关掉</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220912220228931.png" alt="image-20220912220228931"></p>
<h4 id="热力图"><a href="#热力图" class="headerlink" title="热力图"></a>热力图</h4><blockquote>
<p>heatmap：根据位置一一对应填数就行</p>
</blockquote>
<blockquote>
<p>参数列表：</p>
<p>annot：默认False，如果为True，将数字填在热力图表上</p>
<p>cmap：可以填matplotlib的colormaps，要选连续颜色的风格。颜色反转：xxx_r    cool_warm是有对称颜色的，如果要设置的话，选择它</p>
<p>vmin、vmax：设置右侧value的最大最小值</p>
<p>fmt：显示字体的格式，比如<code>&#39;.2f&#39;</code></p>
<p>center：选择右侧数值条的居中颜色是在那个数</p>
<p>cbar：默认为True，为False，则关掉右侧数值条</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220913092432010.png" alt="image-20220913092432010"></p>
<blockquote>
<p>他有一个用途，检测数据之间的相关性</p>
<p>在这里，越靠近一，那么就是正相关，越靠近-1，就是负相关</p>
<p>设置center在这里设和不设一样的，因为定位了最大最小值为1和-1了</p>
<p>这样做的目的就是说我不太关系0附近的点，我关心靠近1和靠近-1的点</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220913093355263.png" alt="image-20220913093355263"></p>
<h4 id="回归图"><a href="#回归图" class="headerlink" title="回归图"></a>回归图</h4><blockquote>
<p>implot()</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;ticks&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the example dataset for Anscombe&#x27;s quartet</span></span><br><span class="line">df = sns.load_dataset(<span class="string">&quot;anscombe&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show the results of a linear regression within each dataset</span></span><br><span class="line">sns.lmplot(</span><br><span class="line">    data=df, x=<span class="string">&quot;x&quot;</span>, y=<span class="string">&quot;y&quot;</span>, col=<span class="string">&quot;dataset&quot;</span>, hue=<span class="string">&quot;dataset&quot;</span>,</span><br><span class="line">    col_wrap=<span class="number">2</span>, palette=<span class="string">&quot;muted&quot;</span>, ci=<span class="literal">None</span>,</span><br><span class="line">    height=<span class="number">4</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/20/python+excel/image-20220913102642142.png" alt="image-20220913102642142"></p>
<h4 id="高级颜色线图"><a href="#高级颜色线图" class="headerlink" title="高级颜色线图"></a>高级颜色线图</h4><blockquote>
<p>relplot()</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220913104825790.png" alt="image-20220913104825790"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;ticks&quot;</span>)</span><br><span class="line"></span><br><span class="line">dots = sns.load_dataset(<span class="string">&quot;dots&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define the palette as a list to specify exact values</span></span><br><span class="line">palette = sns.color_palette(<span class="string">&quot;rocket_r&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot the lines on two facets</span></span><br><span class="line">sns.relplot(</span><br><span class="line">    data=dots,</span><br><span class="line">    x=<span class="string">&quot;time&quot;</span>, y=<span class="string">&quot;firing_rate&quot;</span>,</span><br><span class="line">    hue=<span class="string">&quot;coherence&quot;</span>, size=<span class="string">&quot;choice&quot;</span>, col=<span class="string">&quot;align&quot;</span>,</span><br><span class="line">    kind=<span class="string">&quot;line&quot;</span>, size_order=[<span class="string">&quot;T1&quot;</span>, <span class="string">&quot;T2&quot;</span>], palette=palette,</span><br><span class="line">    height=<span class="number">5</span>, aspect=<span class="number">.75</span>, facet_kws=<span class="built_in">dict</span>(sharex=<span class="literal">False</span>),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="六面体-柱状图"><a href="#六面体-柱状图" class="headerlink" title="六面体+柱状图"></a>六面体+柱状图</h4><p><img src="/2022/08/20/python+excel/image-20220913105430668.png" alt="image-20220913105430668"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;ticks&quot;</span>)</span><br><span class="line"></span><br><span class="line">rs = np.random.RandomState(<span class="number">11</span>)</span><br><span class="line">x = rs.gamma(<span class="number">2</span>, size=<span class="number">1000</span>)</span><br><span class="line">y = -<span class="number">.5</span> * x + rs.normal(size=<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># color是绿色，hex是六边形</span></span><br><span class="line">sns.jointplot(x=x, y=y, kind=<span class="string">&quot;hex&quot;</span>, color=<span class="string">&quot;#4CB391&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="马赛克-柱状图"><a href="#马赛克-柱状图" class="headerlink" title="马赛克+柱状图"></a>马赛克+柱状图</h4><p><img src="/2022/08/20/python+excel/image-20220913114407010.png" alt="image-20220913114407010"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;ticks&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the planets dataset and initialize the figure</span></span><br><span class="line">planets = sns.load_dataset(<span class="string">&quot;planets&quot;</span>)</span><br><span class="line">g = sns.JointGrid(data=planets, x=<span class="string">&quot;year&quot;</span>, y=<span class="string">&quot;distance&quot;</span>, marginal_ticks=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set a log scaling on the y axis</span></span><br><span class="line">g.ax_joint.<span class="built_in">set</span>(yscale=<span class="string">&quot;log&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create an inset legend for the histogram colorbar</span></span><br><span class="line">cax = g.figure.add_axes([<span class="number">.15</span>, <span class="number">.55</span>, <span class="number">.02</span>, <span class="number">.2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add the joint and marginal histogram plots</span></span><br><span class="line">g.plot_joint(</span><br><span class="line">    sns.histplot, discrete=(<span class="literal">True</span>, <span class="literal">False</span>),</span><br><span class="line">    cmap=<span class="string">&quot;light:#03012d&quot;</span>, pmax=<span class="number">.8</span>, cbar=<span class="literal">True</span>, cbar_ax=cax</span><br><span class="line">)</span><br><span class="line">g.plot_marginals(sns.histplot, element=<span class="string">&quot;step&quot;</span>, color=<span class="string">&quot;#03012d&quot;</span>)</span><br></pre></td></tr></table></figure>



<h4 id="堆叠直方图"><a href="#堆叠直方图" class="headerlink" title="堆叠直方图"></a>堆叠直方图</h4><p><img src="/2022/08/20/python+excel/image-20220913112308885.png" alt="image-20220913112308885"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">sns.set_theme(style=<span class="string">&quot;ticks&quot;</span>)</span><br><span class="line"></span><br><span class="line">diamonds = sns.load_dataset(<span class="string">&quot;diamonds&quot;</span>)</span><br><span class="line"></span><br><span class="line">f, ax = plt.subplots(figsize=(<span class="number">7</span>, <span class="number">5</span>))</span><br><span class="line">sns.despine(f)</span><br><span class="line"></span><br><span class="line">sns.histplot(</span><br><span class="line">    diamonds,</span><br><span class="line">    x=<span class="string">&quot;price&quot;</span>, hue=<span class="string">&quot;cut&quot;</span>,</span><br><span class="line">    multiple=<span class="string">&quot;stack&quot;</span>,</span><br><span class="line">    palette=<span class="string">&quot;light:m_r&quot;</span>,</span><br><span class="line">    edgecolor=<span class="string">&quot;.3&quot;</span>,</span><br><span class="line">    linewidth=<span class="number">.5</span>,</span><br><span class="line">    log_scale=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line">ax.xaxis.set_major_formatter(mpl.ticker.ScalarFormatter())</span><br><span class="line">ax.set_xticks([<span class="number">500</span>, <span class="number">1000</span>, <span class="number">2000</span>, <span class="number">5000</span>, <span class="number">10000</span>])</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/20/python+excel/image-20220913113104687.png" alt="image-20220913113104687"></p>
<h4 id="箱型-散点图"><a href="#箱型-散点图" class="headerlink" title="箱型+散点图"></a>箱型+散点图</h4><img src="/2022/08/20/python+excel/image-20220913114240031.png" alt="image-20220913114240031">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">sns.set_theme(style=<span class="string">&quot;ticks&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize the figure with a logarithmic x axis</span></span><br><span class="line">f, ax = plt.subplots(figsize=(<span class="number">7</span>, <span class="number">6</span>))</span><br><span class="line">ax.set_xscale(<span class="string">&quot;log&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the example planets dataset</span></span><br><span class="line">planets = sns.load_dataset(<span class="string">&quot;planets&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot the orbital period with horizontal boxes</span></span><br><span class="line">sns.boxplot(x=<span class="string">&quot;distance&quot;</span>, y=<span class="string">&quot;method&quot;</span>, data=planets,</span><br><span class="line">            whis=[<span class="number">0</span>, <span class="number">100</span>], width=<span class="number">.6</span>, palette=<span class="string">&quot;vlag&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add in points to show each observation</span></span><br><span class="line">sns.scatterplot(x=<span class="string">&quot;distance&quot;</span>, y=<span class="string">&quot;method&quot;</span>, data=planets,</span><br><span class="line">              size=<span class="number">4</span>, color=<span class="string">&quot;.3&quot;</span>, linewidth=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tweak the visual presentation</span></span><br><span class="line">ax.xaxis.grid(<span class="literal">True</span>)</span><br><span class="line">ax.<span class="built_in">set</span>(ylabel=<span class="string">&quot;&quot;</span>)</span><br><span class="line">sns.despine(trim=<span class="literal">True</span>, left=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h4 id="丘陵密度图"><a href="#丘陵密度图" class="headerlink" title="丘陵密度图"></a>丘陵密度图</h4><p><img src="/2022/08/20/python+excel/image-20220913114650659.png" alt="image-20220913114650659"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;white&quot;</span>, rc=&#123;<span class="string">&quot;axes.facecolor&quot;</span>: (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the data</span></span><br><span class="line"><span class="comment">####################改 x  改g list的个数 * 50（任意数字） = 500（任意数字）</span></span><br><span class="line">rs = np.random.RandomState(<span class="number">1979</span>)</span><br><span class="line">x = rs.randn(<span class="number">500</span>)</span><br><span class="line">g = np.tile(<span class="built_in">list</span>(<span class="string">&quot;ABCDEFGHIJ&quot;</span>), <span class="number">50</span>)</span><br><span class="line">df = pd.DataFrame(<span class="built_in">dict</span>(x=x, g=g))</span><br><span class="line">m = df.g.<span class="built_in">map</span>(<span class="built_in">ord</span>)</span><br><span class="line">df[<span class="string">&quot;x&quot;</span>] += m</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize the FacetGrid object</span></span><br><span class="line"><span class="comment">#######################另外list多少个名字，这个10就改成多少</span></span><br><span class="line">pal = sns.cubehelix_palette(<span class="number">10</span>, rot=-<span class="number">.25</span>, light=<span class="number">.7</span>)</span><br><span class="line">g = sns.FacetGrid(df, row=<span class="string">&quot;g&quot;</span>, hue=<span class="string">&quot;g&quot;</span>, aspect=<span class="number">15</span>, height=<span class="number">.5</span>, palette=pal)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Draw the densities in a few steps</span></span><br><span class="line">g.<span class="built_in">map</span>(sns.kdeplot, <span class="string">&quot;x&quot;</span>,</span><br><span class="line">      bw_adjust=<span class="number">.5</span>, clip_on=<span class="literal">False</span>,</span><br><span class="line">      fill=<span class="literal">True</span>, alpha=<span class="number">1</span>, linewidth=<span class="number">1.5</span>)</span><br><span class="line">g.<span class="built_in">map</span>(sns.kdeplot, <span class="string">&quot;x&quot;</span>, clip_on=<span class="literal">False</span>, color=<span class="string">&quot;w&quot;</span>, lw=<span class="number">2</span>, bw_adjust=<span class="number">.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># passing color=None to refline() uses the hue mapping</span></span><br><span class="line">g.refline(y=<span class="number">0</span>, linewidth=<span class="number">2</span>, linestyle=<span class="string">&quot;-&quot;</span>, color=<span class="literal">None</span>, clip_on=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define and use a simple function to label the plot in axes coordinates</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">label</span>(<span class="params">x, color, label</span>):</span></span><br><span class="line">    ax = plt.gca()</span><br><span class="line">    ax.text(<span class="number">0</span>, <span class="number">.2</span>, label, fontweight=<span class="string">&quot;bold&quot;</span>, color=color,</span><br><span class="line">            ha=<span class="string">&quot;left&quot;</span>, va=<span class="string">&quot;center&quot;</span>, transform=ax.transAxes)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">g.<span class="built_in">map</span>(label, <span class="string">&quot;x&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the subplots to overlap</span></span><br><span class="line">g.figure.subplots_adjust(hspace=-<span class="number">.25</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove axes details that don&#x27;t play well with overlap</span></span><br><span class="line">g.set_titles(<span class="string">&quot;&quot;</span>)</span><br><span class="line">g.<span class="built_in">set</span>(yticks=[], ylabel=<span class="string">&quot;&quot;</span>)</span><br><span class="line">g.despine(bottom=<span class="literal">True</span>, left=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h4 id="多维度密度聚类"><a href="#多维度密度聚类" class="headerlink" title="多维度密度聚类"></a>多维度密度聚类</h4><blockquote>
<p>这个例子好像是物种的长宽分布？</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220913140112002.png" alt="image-20220913140112002"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;ticks&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the penguins dataset</span></span><br><span class="line">penguins = sns.load_dataset(<span class="string">&quot;penguins&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show the joint distribution using kernel density estimation</span></span><br><span class="line">g = sns.jointplot(</span><br><span class="line">    data=penguins,</span><br><span class="line">    x=<span class="string">&quot;bill_length_mm&quot;</span>, y=<span class="string">&quot;bill_depth_mm&quot;</span>, hue=<span class="string">&quot;species&quot;</span>,</span><br><span class="line">    kind=<span class="string">&quot;kde&quot;</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="箱盒图"><a href="#箱盒图" class="headerlink" title="箱盒图"></a>箱盒图</h4><blockquote>
<p>棱形方块就是离群点</p>
<p><strong>k_depth</strong>：“proportion” 或 “tukey” 或 “trustworthy”<br>通过增大百分比的粒度控制绘制的盒形图数目。每个参数代表利用不同的统计特性对异常值的数量做出不同的假设。</p>
<p><strong>scale</strong>：“linear” 或 “exponential” 或 “area”<br>用于控制增强箱型图宽度的方法。所有参数都会给显示效果造成影响。 “linear” 通过恒定的线性因子减小宽度，“exponential” 使用未覆盖的数据的比例调整宽度， “area” 与所覆盖的数据的百分比成比例。</p>
<p><strong>outlier_prop</strong>：float<br>被认为是异常值的数据比例。与 k_depth 结合使用以确定要绘制的百分位数。默认值为 0.007 作为异常值的比例。该参数取值应在[0,1]范围内。</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220913140534260.png" alt="image-20220913140534260"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;whitegrid&quot;</span>)</span><br><span class="line"></span><br><span class="line">diamonds = sns.load_dataset(<span class="string">&quot;diamonds&quot;</span>)</span><br><span class="line">clarity_ranking = [<span class="string">&quot;I1&quot;</span>, <span class="string">&quot;SI2&quot;</span>, <span class="string">&quot;SI1&quot;</span>, <span class="string">&quot;VS2&quot;</span>, <span class="string">&quot;VS1&quot;</span>, <span class="string">&quot;VVS2&quot;</span>, <span class="string">&quot;VVS1&quot;</span>, <span class="string">&quot;IF&quot;</span>]</span><br><span class="line"></span><br><span class="line">sns.boxenplot(x=<span class="string">&quot;clarity&quot;</span>, y=<span class="string">&quot;carat&quot;</span>,</span><br><span class="line">              color=<span class="string">&quot;b&quot;</span>, order=clarity_ranking,</span><br><span class="line">              scale=<span class="string">&quot;linear&quot;</span>, data=diamonds)</span><br></pre></td></tr></table></figure>

<h4 id="高贵蓝宝石密度图"><a href="#高贵蓝宝石密度图" class="headerlink" title="高贵蓝宝石密度图"></a>高贵蓝宝石密度图</h4><blockquote>
<p>绘制具有密度等值线的组合直方图和散点图</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;dark&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Simulate data from a bivariate Gaussian</span></span><br><span class="line"><span class="comment">#################xy改成自己想要的就好了</span></span><br><span class="line">n = <span class="number">10000</span></span><br><span class="line">mean = [<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">cov = [(<span class="number">2</span>, <span class="number">.4</span>), (<span class="number">.4</span>, <span class="number">.2</span>)]</span><br><span class="line">rng = np.random.RandomState(<span class="number">0</span>)</span><br><span class="line">x, y = rng.multivariate_normal(mean, cov, n).T</span><br><span class="line"></span><br><span class="line"><span class="comment"># Draw a combo histogram and scatterplot with density contours</span></span><br><span class="line">f, ax = plt.subplots(figsize=(<span class="number">6</span>, <span class="number">6</span>))</span><br><span class="line">sns.scatterplot(x=x, y=y, s=<span class="number">5</span>, color=<span class="string">&quot;.15&quot;</span>)</span><br><span class="line">sns.histplot(x=x, y=y, bins=<span class="number">50</span>, pthresh=<span class="number">.1</span>, cmap=<span class="string">&quot;mako&quot;</span>)</span><br><span class="line">sns.kdeplot(x=x, y=y, levels=<span class="number">5</span>, color=<span class="string">&quot;w&quot;</span>, linewidths=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h4 id="logistic曲线绘制"><a href="#logistic曲线绘制" class="headerlink" title="logistic曲线绘制"></a>logistic曲线绘制</h4><blockquote>
<p>logistic：调用logistic函数，需要import statsmodels</p>
<p>truncate：默认为True，改为False之后将不将曲线延长（比如这里红色的线，False的时候就后面那一节没有</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220913142407671.png" alt="image-20220913142407671"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> statsmodels</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;darkgrid&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the example Titanic dataset</span></span><br><span class="line">df = sns.load_dataset(<span class="string">&quot;titanic&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make a custom palette with gendered colors</span></span><br><span class="line">pal = <span class="built_in">dict</span>(male=<span class="string">&quot;#6495ED&quot;</span>, female=<span class="string">&quot;#F08080&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show the survival probability as a function of age and sex</span></span><br><span class="line">g = sns.lmplot(x=<span class="string">&quot;age&quot;</span>, y=<span class="string">&quot;survived&quot;</span>, col=<span class="string">&quot;sex&quot;</span>, hue=<span class="string">&quot;sex&quot;</span>, data=df,</span><br><span class="line">               palette=pal, y_jitter=<span class="number">.02</span>, logistic=<span class="literal">True</span>, truncate=<span class="literal">False</span>)</span><br><span class="line">g.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">80</span>), ylim=(-<span class="number">.05</span>, <span class="number">1.05</span>))</span><br></pre></td></tr></table></figure>

<h4 id="步长图"><a href="#步长图" class="headerlink" title="步长图"></a>步长图</h4><p><img src="/2022/08/20/python+excel/image-20220913143823852.png" alt="image-20220913143823852"></p>
<blockquote>
<p>用到在学，感觉用不到<a target="_blank" rel="noopener" href="http://seaborn.pydata.org/examples/many_facets.html">Plotting on a large number of facets — seaborn 0.12.0 documentation (pydata.org)</a></p>
</blockquote>
<h4 id="半热力图"><a href="#半热力图" class="headerlink" title="半热力图"></a>半热力图</h4><blockquote>
<p>主要在于mask，将mask传入heatmap即可</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220913144508478.png" alt="image-20220913144508478"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">sns.set_theme(style=<span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate a large random dataset</span></span><br><span class="line">rs = np.random.RandomState(<span class="number">33</span>)</span><br><span class="line">d = pd.DataFrame(data=rs.normal(size=(<span class="number">100</span>, <span class="number">26</span>)),</span><br><span class="line">                 columns=<span class="built_in">list</span>(ascii_letters[<span class="number">26</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute the correlation matrix</span></span><br><span class="line">corr = d.corr()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate a mask for the upper triangle</span></span><br><span class="line">mask = np.triu(np.ones_like(corr, dtype=<span class="built_in">bool</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up the matplotlib figure</span></span><br><span class="line">f, ax = plt.subplots(figsize=(<span class="number">11</span>, <span class="number">9</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate a custom diverging colormap</span></span><br><span class="line">cmap = sns.diverging_palette(<span class="number">230</span>, <span class="number">20</span>, as_cmap=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Draw the heatmap with the mask and correct aspect ratio</span></span><br><span class="line">sns.heatmap(corr, mask=mask, cmap=cmap, vmax=<span class="number">.3</span>, center=<span class="number">0</span>,</span><br><span class="line">            square=<span class="literal">True</span>, linewidths=<span class="number">.5</span>, cbar_kws=&#123;<span class="string">&quot;shrink&quot;</span>: <span class="number">.5</span>&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="回归-分布图"><a href="#回归-分布图" class="headerlink" title="回归+分布图"></a>回归+分布图</h4><blockquote>
<p>同样是你最爱的jointplot()</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220913153241567.png" alt="image-20220913153241567"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;darkgrid&quot;</span>)</span><br><span class="line"></span><br><span class="line">tips = sns.load_dataset(<span class="string">&quot;tips&quot;</span>)</span><br><span class="line">g = sns.jointplot(x=<span class="string">&quot;total_bill&quot;</span>, y=<span class="string">&quot;tip&quot;</span>, data=tips,</span><br><span class="line">                  kind=<span class="string">&quot;reg&quot;</span>, truncate=<span class="literal">False</span>,</span><br><span class="line">                  xlim=(<span class="number">0</span>, <span class="number">60</span>), ylim=(<span class="number">0</span>, <span class="number">12</span>),</span><br><span class="line">                  color=<span class="string">&quot;m&quot;</span>, height=<span class="number">7</span>)</span><br></pre></td></tr></table></figure>

<h4 id="残差图"><a href="#残差图" class="headerlink" title="残差图"></a>残差图</h4><p><img src="/2022/08/20/python+excel/image-20220913153518153.png" alt="image-20220913153518153"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;whitegrid&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make an example dataset with y ~ x</span></span><br><span class="line">rs = np.random.RandomState(<span class="number">7</span>)</span><br><span class="line">x = rs.normal(<span class="number">2</span>, <span class="number">1</span>, <span class="number">75</span>)</span><br><span class="line">y = <span class="number">2</span> + <span class="number">1.5</span> * x + rs.normal(<span class="number">0</span>, <span class="number">2</span>, <span class="number">75</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot the residuals after fitting a linear model</span></span><br><span class="line">sns.residplot(x=x, y=y, lowess=<span class="literal">True</span>, color=<span class="string">&quot;g&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="散点-分布图"><a href="#散点-分布图" class="headerlink" title="散点+分布图"></a>散点+分布图</h4><blockquote>
<p>他好像拿出了四个参数作为轴，同时画了四个图</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220913153617926.png" alt="image-20220913153617926"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;ticks&quot;</span>)</span><br><span class="line"></span><br><span class="line">df = sns.load_dataset(<span class="string">&quot;penguins&quot;</span>)</span><br><span class="line">sns.pairplot(df, hue=<span class="string">&quot;species&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="深邃热力-条形"><a href="#深邃热力-条形" class="headerlink" title="深邃热力+条形"></a>深邃热力+条形</h4><p><img src="/2022/08/20/python+excel/image-20220913153827485.png" alt="image-20220913153827485"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line">df = sns.load_dataset(<span class="string">&quot;penguins&quot;</span>)</span><br><span class="line"></span><br><span class="line">g = sns.JointGrid(data=df, x=<span class="string">&quot;body_mass_g&quot;</span>, y=<span class="string">&quot;bill_depth_mm&quot;</span>, space=<span class="number">0</span>)</span><br><span class="line">g.plot_joint(sns.kdeplot,</span><br><span class="line">             fill=<span class="literal">True</span>, clip=((<span class="number">2200</span>, <span class="number">6800</span>), (<span class="number">10</span>, <span class="number">25</span>)),</span><br><span class="line">             thresh=<span class="number">0</span>, levels=<span class="number">100</span>, cmap=<span class="string">&quot;rocket&quot;</span>)</span><br><span class="line">g.plot_marginals(sns.histplot, color=<span class="string">&quot;#03051A&quot;</span>, alpha=<span class="number">1</span>, bins=<span class="number">25</span>)</span><br></pre></td></tr></table></figure>

<h4 id="带回归线的散点条形图"><a href="#带回归线的散点条形图" class="headerlink" title="带回归线的散点条形图"></a>带回归线的散点条形图</h4><p><img src="/2022/08/20/python+excel/image-20220913154553697.png" alt="image-20220913154553697"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme()</span><br><span class="line"></span><br><span class="line">mpg = sns.load_dataset(<span class="string">&quot;mpg&quot;</span>)</span><br><span class="line">sns.catplot(</span><br><span class="line">    data=mpg, x=<span class="string">&quot;cylinders&quot;</span>, y=<span class="string">&quot;acceleration&quot;</span>, hue=<span class="string">&quot;weight&quot;</span>,</span><br><span class="line">    native_scale=<span class="literal">True</span>, zorder=<span class="number">1</span></span><br><span class="line">)</span><br><span class="line">sns.regplot(</span><br><span class="line">    data=mpg, x=<span class="string">&quot;cylinders&quot;</span>, y=<span class="string">&quot;acceleration&quot;</span>,</span><br><span class="line">    scatter=<span class="literal">False</span>, truncate=<span class="literal">False</span>, order=<span class="number">2</span>, color=<span class="string">&quot;.2&quot;</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="热力图-树状图"><a href="#热力图-树状图" class="headerlink" title="热力图+树状图"></a>热力图+树状图</h4><blockquote>
<p>这个是指，多层索引传入，才可以画出来</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220913160340988.png" alt="image-20220913160340988"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the brain networks example dataset</span></span><br><span class="line">df = sns.load_dataset(<span class="string">&quot;brain_networks&quot;</span>, header=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], index_col=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Select a subset of the networks</span></span><br><span class="line">used_networks = [<span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">17</span>]</span><br><span class="line">used_columns = (df.columns.get_level_values(<span class="string">&quot;network&quot;</span>)</span><br><span class="line">                          .astype(<span class="built_in">int</span>)</span><br><span class="line">                          .isin(used_networks))</span><br><span class="line">df = df.loc[:, used_columns]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a categorical palette to identify the networks</span></span><br><span class="line">network_pal = sns.husl_palette(<span class="number">8</span>, s=<span class="number">.45</span>)</span><br><span class="line">network_lut = <span class="built_in">dict</span>(<span class="built_in">zip</span>(<span class="built_in">map</span>(<span class="built_in">str</span>, used_networks), network_pal))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert the palette to vectors that will be drawn on the side of the matrix</span></span><br><span class="line">networks = df.columns.get_level_values(<span class="string">&quot;network&quot;</span>)</span><br><span class="line">network_colors = pd.Series(networks, index=df.columns).<span class="built_in">map</span>(network_lut)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Draw the full plot</span></span><br><span class="line">g = sns.clustermap(df.corr(), center=<span class="number">0</span>, cmap=<span class="string">&quot;vlag&quot;</span>,</span><br><span class="line">                   row_colors=network_colors, col_colors=network_colors,</span><br><span class="line">                   dendrogram_ratio=(<span class="number">.1</span>, <span class="number">.2</span>),</span><br><span class="line">                   cbar_pos=(<span class="number">.02</span>, <span class="number">.32</span>, <span class="number">.03</span>, <span class="number">.2</span>),</span><br><span class="line">                   linewidths=<span class="number">.75</span>, figsize=(<span class="number">12</span>, <span class="number">13</span>))</span><br><span class="line"></span><br><span class="line">g.ax_row_dendrogram.remove()</span><br></pre></td></tr></table></figure>

<h4 id="多重时间序列"><a href="#多重时间序列" class="headerlink" title="多重时间序列"></a>多重时间序列</h4><p><img src="/2022/08/20/python+excel/image-20220913163645960.png" alt="image-20220913163645960"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line">sns.set_theme(style=<span class="string">&quot;dark&quot;</span>)</span><br><span class="line">flights = sns.load_dataset(<span class="string">&quot;flights&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot each year&#x27;s time series in its own facet</span></span><br><span class="line">g = sns.relplot(</span><br><span class="line">    data=flights,</span><br><span class="line">    x=<span class="string">&quot;month&quot;</span>, y=<span class="string">&quot;passengers&quot;</span>, col=<span class="string">&quot;year&quot;</span>, hue=<span class="string">&quot;year&quot;</span>,</span><br><span class="line">    kind=<span class="string">&quot;line&quot;</span>, palette=<span class="string">&quot;crest&quot;</span>, linewidth=<span class="number">4</span>, zorder=<span class="number">5</span>,</span><br><span class="line">    col_wrap=<span class="number">3</span>, height=<span class="number">2</span>, aspect=<span class="number">1.5</span>, legend=<span class="literal">False</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Iterate over each subplot to customize further</span></span><br><span class="line"><span class="keyword">for</span> year, ax <span class="keyword">in</span> g.axes_dict.items():</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Add the title as an annotation within the plot</span></span><br><span class="line">    ax.text(<span class="number">.8</span>, <span class="number">.85</span>, year, transform=ax.transAxes, fontweight=<span class="string">&quot;bold&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Plot every year&#x27;s time series in the background</span></span><br><span class="line">    sns.lineplot(</span><br><span class="line">        data=flights, x=<span class="string">&quot;month&quot;</span>, y=<span class="string">&quot;passengers&quot;</span>, units=<span class="string">&quot;year&quot;</span>,</span><br><span class="line">        estimator=<span class="literal">None</span>, color=<span class="string">&quot;.7&quot;</span>, linewidth=<span class="number">1</span>, ax=ax,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="comment"># Reduce the frequency of the x axis ticks</span></span><br><span class="line">ax.set_xticks(ax.get_xticks()[::<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tweak the supporting aspects of the plot</span></span><br><span class="line">g.set_titles(<span class="string">&quot;&quot;</span>)</span><br><span class="line">g.set_axis_labels(<span class="string">&quot;&quot;</span>, <span class="string">&quot;Passengers&quot;</span>)</span><br><span class="line">g.tight_layout()</span><br></pre></td></tr></table></figure>

<h4 id="丰富多彩的线图"><a href="#丰富多彩的线图" class="headerlink" title="丰富多彩的线图"></a>丰富多彩的线图</h4><p><img src="/2022/08/20/python+excel/image-20220913163818729.png" alt="image-20220913163818729"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.set_theme(style=<span class="string">&quot;whitegrid&quot;</span>)</span><br><span class="line"></span><br><span class="line">rs = np.random.RandomState(<span class="number">365</span>)</span><br><span class="line"><span class="comment"># cumsum axis=0时，返回行的累计和，也就是第二行变成了原本的第二行+第一行的值</span></span><br><span class="line"><span class="comment"># randn(365, 4)返回的是365 * 4的一个numpy的n维数组</span></span><br><span class="line">values = rs.randn(<span class="number">365</span>, <span class="number">4</span>).cumsum(axis=<span class="number">0</span>)</span><br><span class="line">dates = pd.date_range(<span class="string">&quot;1 1 2016&quot;</span>, periods=<span class="number">365</span>, freq=<span class="string">&quot;D&quot;</span>)</span><br><span class="line">data = pd.DataFrame(values, dates, columns=[<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>])</span><br><span class="line">data = data.rolling(<span class="number">7</span>).mean()</span><br><span class="line">sns.lineplot(data=data, palette=<span class="string">&quot;tab10&quot;</span>, linewidth=<span class="number">2.5</span>)</span><br></pre></td></tr></table></figure>

<h4 id="生成Mp4，gif"><a href="#生成Mp4，gif" class="headerlink" title="生成Mp4，gif"></a>生成Mp4，gif</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">一图胜千言</span></span><br><span class="line"><span class="string">动图胜万言</span></span><br><span class="line"><span class="string">python 生成</span></span><br><span class="line"><span class="string">gif, mp4</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> animation</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">xdata = []</span><br><span class="line">ydata = []</span><br><span class="line"></span><br><span class="line">line, = plt.plot(xdata, ydata, <span class="string">&#x27;r-&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span>():</span></span><br><span class="line">    <span class="comment"># 定轴</span></span><br><span class="line">    ax.set_xlim(-<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">    ax.set_ylim(-<span class="number">1</span>, <span class="number">30</span>)</span><br><span class="line">    <span class="comment"># 返回的是一个子图，由于subplot没有指定大小，所以最终就只显示一个图吧</span></span><br><span class="line">    <span class="keyword">return</span> line,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">frame</span>):</span>  <span class="comment"># 帧</span></span><br><span class="line">    <span class="built_in">print</span>(frame)</span><br><span class="line">    xdata.append(frame)</span><br><span class="line">    ydata.append(frame ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    line.set_data(xdata, ydata)</span><br><span class="line">    <span class="keyword">return</span> line,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ani = animation.FuncAnimation(</span><br><span class="line">    <span class="comment"># 表示是在那个轴的基础上干的</span></span><br><span class="line">    fig=fig,</span><br><span class="line">    <span class="comment"># func就是每一帧该干的事</span></span><br><span class="line">    func=update,</span><br><span class="line">    <span class="comment"># frames=[1, 2, 3],</span></span><br><span class="line">    <span class="comment"># 0 - 5线性插值作为基础数据，画均匀增大的直线</span></span><br><span class="line">    frames=np.linspace(<span class="number">0</span>, <span class="number">5</span>, <span class="number">100</span>),</span><br><span class="line">    <span class="comment"># frames=5,</span></span><br><span class="line">    <span class="comment"># 初始化函数</span></span><br><span class="line">    init_func=init,</span><br><span class="line">    <span class="comment"># 每隔多长时间生成一张动图</span></span><br><span class="line">    <span class="comment"># 用间隔乘以帧（点数）来</span></span><br><span class="line">    interval=<span class="number">100</span>,  <span class="comment"># 时间间隔: 毫秒</span></span><br><span class="line">    <span class="comment"># 是否重复播放</span></span><br><span class="line">    repeat=<span class="literal">False</span></span><br><span class="line">)</span><br><span class="line"><span class="comment"># plt.show()</span></span><br><span class="line"><span class="comment"># gif和mp4每次只生成一个</span></span><br><span class="line">ani.save(<span class="string">&#x27;1.gif&#x27;</span>, writer=<span class="string">&#x27;pillow&#x27;</span>)</span><br><span class="line"><span class="comment"># ani.save(&#x27;1.mp4&#x27;)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="多图同屏版本"><a href="#多图同屏版本" class="headerlink" title="多图同屏版本"></a>多图同屏版本</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> animation</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 固定的线</span></span><br><span class="line">plt.plot([<span class="number">1</span>, <span class="number">2</span>], [<span class="number">10</span>, <span class="number">20</span>], <span class="string">&#x27;b-&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 线1</span></span><br><span class="line">xdata = []</span><br><span class="line">ydata = []</span><br><span class="line">line, = plt.plot(xdata, ydata, <span class="string">&#x27;r-&#x27;</span>)</span><br><span class="line"><span class="comment"># 线2</span></span><br><span class="line">xdata2 = []</span><br><span class="line">ydata2 = []</span><br><span class="line">line2, = plt.plot(xdata2, ydata2, <span class="string">&#x27;g-&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文字</span></span><br><span class="line">x_template = <span class="string">&#x27;x = %.2f&#x27;</span></span><br><span class="line"><span class="comment"># 0.05,0.9即占xy图的位置比例，这个也就是左上角</span></span><br><span class="line">x_text = ax.text(<span class="number">0.05</span>, <span class="number">0.9</span>, <span class="string">&#x27;&#x27;</span>, transform=ax.transAxes)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span>():</span></span><br><span class="line">    ax.set_xlim(-<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">    ax.set_ylim(-<span class="number">1</span>, <span class="number">30</span>)</span><br><span class="line">    <span class="keyword">return</span> line, line2, x_text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">frame, n</span>):</span>  <span class="comment"># 帧</span></span><br><span class="line">    <span class="built_in">print</span>(frame)</span><br><span class="line">    <span class="comment"># 线1</span></span><br><span class="line">    xdata.append(frame)</span><br><span class="line">    ydata.append(frame ** <span class="number">2</span>)</span><br><span class="line">    line.set_data(xdata, ydata)</span><br><span class="line">    <span class="comment"># 线2</span></span><br><span class="line">    xdata2.append(frame)</span><br><span class="line">    ydata2.append(frame ** n)</span><br><span class="line">    line2.set_data(xdata2, ydata2)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 文字</span></span><br><span class="line">    x_text.set_text(x_template % frame)</span><br><span class="line">    <span class="keyword">return</span> line, line2, x_text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ani = animation.FuncAnimation(</span><br><span class="line">    fig=fig,</span><br><span class="line">    func=update,</span><br><span class="line">    <span class="comment"># frames=[1, 2, 3],</span></span><br><span class="line">    frames=np.linspace(<span class="number">0</span>, <span class="number">5</span>, <span class="number">100</span>),</span><br><span class="line">    <span class="comment"># frames=5,</span></span><br><span class="line">    init_func=init,</span><br><span class="line">    interval=<span class="number">100</span>,  <span class="comment"># 时间间隔: 毫秒</span></span><br><span class="line">    repeat=<span class="literal">False</span>,</span><br><span class="line">    <span class="comment"># blit参数，默认为False，即每次画图都将之前的删除重画，为True时代表不删除。</span></span><br><span class="line">    blit=<span class="literal">True</span>,</span><br><span class="line">    <span class="comment"># fargs需要传入元祖，是用来传入update的参数, 例如这样就是传入update一个固定参数，还可以逗号后再传参数</span></span><br><span class="line">    <span class="comment"># 总之就是可以传入多个参数</span></span><br><span class="line">    fargs=(<span class="number">4</span>,)</span><br><span class="line">)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># ani.save(&#x27;1.gif&#x27;, writer=&#x27;pillow&#x27;)</span></span><br><span class="line"><span class="comment"># ani.save(&#x27;1.mp4&#x27;)</span></span><br></pre></td></tr></table></figure>

<h2 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h2><h3 id="主要步骤"><a href="#主要步骤" class="headerlink" title="主要步骤"></a>主要步骤</h3><blockquote>
<p>合并单平台表</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220921113506268.png" alt="image-20220921113506268"></p>
<blockquote>
<p>JD TB双平台 + 各种咋二八斤的表合并</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220921113629745.png" alt="image-20220921113629745"></p>
<p><img src="/2022/08/20/python+excel/image-20220921113909838.png" alt="image-20220921113909838"></p>
<blockquote>
<p>得出信息</p>
</blockquote>
<p><img src="/2022/08/20/python+excel/image-20220921114000698.png" alt="image-20220921114000698"></p>
<p>这里只给出我看到的一些，值得注意的细节：</p>
<p><img src="/2022/08/20/python+excel/image-20220921115055525.png" alt="image-20220921115055525"></p>
<p>，将退货数量为0的列，设置其退货金额为0</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:jjyaoao@126.com">jjyaoao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://jjyaoao.space/2022/08/20/python+excel/">http://jjyaoao.space/2022/08/20/python+excel/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://jjyaoao.space" target="_blank">jjyaoao's Home</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%81%97%E5%BF%98%E6%8C%87%E5%8D%97/">遗忘指南</a><a class="post-meta__tags" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-61dbf69078ce19aa" async="async"></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://s2.loli.net/2022/01/09/HMjygFAKr2nPWdJ.jpg" target="_blank"><img class="post-qr-code-img" src="https://s2.loli.net/2022/01/09/HMjygFAKr2nPWdJ.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://s2.loli.net/2022/01/09/JL43sbhxUEOuVeM.jpg" target="_blank"><img class="post-qr-code-img" src="https://s2.loli.net/2022/01/09/JL43sbhxUEOuVeM.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/08/21/Shell%E8%84%9A%E6%9C%AC/"><img class="prev-cover" src="https://s2.loli.net/2022/04/15/YXoFfbxgWZIn1SM.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">shell脚本</div></div></a></div><div class="next-post pull-right"><a href="/2022/08/17/22%E5%B9%B4%E5%A4%87%E6%88%98%E6%95%B0%E6%A8%A1%E5%9B%BD%E8%B5%9B/"><img class="next-cover" src="https://s2.loli.net/2022/04/15/YXoFfbxgWZIn1SM.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">2022备战国赛</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/04/15/C++%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" title="C++项目实战"><img class="cover" src="https://s2.loli.net/2022/04/15/YXoFfbxgWZIn1SM.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-15</div><div class="title">C++项目实战</div></div></a></div><div><a href="/2022/08/17/22%E5%B9%B4%E5%A4%87%E6%88%98%E6%95%B0%E6%A8%A1%E5%9B%BD%E8%B5%9B/" title="2022备战国赛"><img class="cover" src="https://s2.loli.net/2022/04/15/YXoFfbxgWZIn1SM.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-17</div><div class="title">2022备战国赛</div></div></a></div><div><a href="/2022/09/15/Cmake+Vscode+C++%E5%BC%80%E5%8F%91/" title="Cmake+vscode+C++"><img class="cover" src="https://s2.loli.net/2022/04/15/YXoFfbxgWZIn1SM.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-15</div><div class="title">Cmake+vscode+C++</div></div></a></div><div><a href="/2022/09/10/Git/" title="Git"><img class="cover" src="https://s2.loli.net/2022/04/15/YXoFfbxgWZIn1SM.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-10</div><div class="title">Git</div></div></a></div><div><a href="/2022/08/23/Geatpy-python%E4%BC%98%E5%8C%96%E5%BA%93/" title="Geatpy-python优化库"><img class="cover" src="https://s2.loli.net/2022/04/15/YXoFfbxgWZIn1SM.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-23</div><div class="title">Geatpy-python优化库</div></div></a></div><div><a href="/2022/04/15/Linux%E5%AD%A6%E4%B9%A0/" title="Linux学习"><img class="cover" src="https://s2.loli.net/2022/04/15/FltTRVUfbzYIowQ.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-15</div><div class="title">Linux学习</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Livere</span><span class="switch-btn"></span><span class="second-comment">Valine</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81NTM1OC8zMTgyNQ=="></div></div><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Pandas%E5%B7%A5%E5%85%B7%E7%AE%80%E8%A6%81%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">Pandas工具简要介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#append"><span class="toc-number">1.1.</span> <span class="toc-text">append()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#join"><span class="toc-number">1.2.</span> <span class="toc-text">join()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#concat"><span class="toc-number">1.3.</span> <span class="toc-text">concat()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#merge"><span class="toc-number">1.4.</span> <span class="toc-text">merge()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pivot-table"><span class="toc-number">1.5.</span> <span class="toc-text">pivot_table()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E8%81%8C%E4%BD%8D%E5%B1%95%E7%A4%BA"><span class="toc-number">2.</span> <span class="toc-text">工作职位展示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pandas%E7%AE%80%E4%BB%8B"><span class="toc-number">3.</span> <span class="toc-text">Pandas简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Series-amp-DataFrame"><span class="toc-number">4.</span> <span class="toc-text">Series &amp; DataFrame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#read-excel-%E5%8F%82%E6%95%B0%E4%BB%8B%E7%BB%8D"><span class="toc-number">5.</span> <span class="toc-text">read_excel()参数介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%AD%90%E8%A1%A8"><span class="toc-number">5.1.</span> <span class="toc-text">选择子表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E8%A1%A8%E5%A4%B4"><span class="toc-number">5.2.</span> <span class="toc-text">指定表头</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E4%BD%BF%E7%94%A8%E5%88%97"><span class="toc-number">5.3.</span> <span class="toc-text">指定使用列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%BF%87%E4%B8%8D%E8%A6%81%E7%9A%84%E8%A1%8C"><span class="toc-number">5.4.</span> <span class="toc-text">跳过不要的行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%88%97%E5%90%8D"><span class="toc-number">5.5.</span> <span class="toc-text">设置列名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%88%97%E5%90%8D%E5%92%8C%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.6.</span> <span class="toc-text">定义列名和类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#dtype%E7%B1%BB%E5%9E%8B%E5%A4%A7%E5%85%A8"><span class="toc-number">5.6.1.</span> <span class="toc-text">dtype类型大全</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E6%9C%9F%E8%A7%A3%E6%9E%90"><span class="toc-number">5.7.</span> <span class="toc-text">自定义日期解析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#parse-dates"><span class="toc-number">5.7.1.</span> <span class="toc-text">parse_dates</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#date-parser"><span class="toc-number">5.7.2.</span> <span class="toc-text">date_parser</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-number">5.8.</span> <span class="toc-text">处理缺失值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%80%BC%E8%BD%AC%E6%8D%A2%EF%BC%88-%EF%BC%89"><span class="toc-number">5.9.</span> <span class="toc-text">值转换（+-*&#x2F;）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%ACbool"><span class="toc-number">5.10.</span> <span class="toc-text">字符串转bool</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%8F%82%E6%95%B0%E8%A1%A5%E5%85%85"><span class="toc-number">5.11.</span> <span class="toc-text">其他参数补充</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9Aindex"><span class="toc-number">5.11.1.</span> <span class="toc-text">指定index</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E5%90%A6%E8%BD%AC%E6%8D%A2%E6%95%B0%E6%8D%AE%E4%B8%BAseries"><span class="toc-number">5.11.2.</span> <span class="toc-text">是否转换数据为series</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E5%90%A6%E9%87%8D%E5%91%BD%E5%90%8D%E5%88%97"><span class="toc-number">5.11.3.</span> <span class="toc-text">是否重命名列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E8%A7%A3%E6%9E%90%E8%A1%8C"><span class="toc-number">5.11.4.</span> <span class="toc-text">指定解析行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%96%87%E6%9C%AC%E8%A7%A3%E6%9E%90%E4%B8%BA%E6%95%B0%E5%AD%97"><span class="toc-number">5.11.5.</span> <span class="toc-text">字符串文本解析为数字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E5%90%A6%E8%BD%AC%E6%B5%AE%E7%82%B9%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.11.6.</span> <span class="toc-text">是否转浮点类型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#to-excel-%E5%8F%82%E6%95%B0%E4%BB%8B%E7%BB%8D"><span class="toc-number">6.</span> <span class="toc-text">to_excel()参数介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%AF%E5%90%A6%E8%BE%93%E5%87%BA%E8%A1%8C%E7%B4%A2%E5%BC%95"><span class="toc-number">6.1.</span> <span class="toc-text">是否输出行索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E5%90%8D%E8%A1%A8%E5%90%8D%EF%BC%8C%E8%A7%84%E8%8C%83float%E6%A0%BC%E5%BC%8F%EF%BC%8C%E8%AE%BE%E7%BD%AE%E7%A9%BA"><span class="toc-number">6.2.</span> <span class="toc-text">命名表名，规范float格式，设置空</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ExcelWriter-%E5%8F%82%E6%95%B0%E4%BB%8B%E7%BB%8D"><span class="toc-number">7.</span> <span class="toc-text">ExcelWriter()参数介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99-%E8%AF%BBcsv"><span class="toc-number">8.</span> <span class="toc-text">写&#x2F;读csv</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%86%99pickle%E6%96%87%E4%BB%B6"><span class="toc-number">9.</span> <span class="toc-text">读写pickle文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pandas-sql"><span class="toc-number">10.</span> <span class="toc-text">pandas + sql</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#to-sql"><span class="toc-number">10.1.</span> <span class="toc-text">to_sql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#read-sql"><span class="toc-number">10.2.</span> <span class="toc-text">read_sql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql%E6%89%A7%E8%A1%8C"><span class="toc-number">10.3.</span> <span class="toc-text">mysql执行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#index%E7%B4%A2%E5%BC%95"><span class="toc-number">11.</span> <span class="toc-text">index索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%86%E5%88%AB"><span class="toc-number">11.1.</span> <span class="toc-text">识别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E9%BD%90"><span class="toc-number">11.2.</span> <span class="toc-text">对齐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%92%8C%E8%AE%BE%E7%BD%AE"><span class="toc-number">11.3.</span> <span class="toc-text">获取和设置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8Bdataframe%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="toc-number">12.</span> <span class="toc-text">查看dataframe基本信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#info"><span class="toc-number">12.1.</span> <span class="toc-text">info()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#describe"><span class="toc-number">12.2.</span> <span class="toc-text">describe()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%A0%B7%E6%9C%AC%E6%A0%87%E5%87%86%E5%B7%AE"><span class="toc-number">12.3.</span> <span class="toc-text">什么是样本标准差</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#25"><span class="toc-number">12.3.1.</span> <span class="toc-text">25%</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#to-numpy"><span class="toc-number">12.4.</span> <span class="toc-text">to_numpy()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BD%99%E4%B8%80%E4%BA%9B%E5%8F%82%E6%95%B0%E7%9A%84%E6%B5%8B%E8%AF%95"><span class="toc-number">12.5.</span> <span class="toc-text">其余一些参数的测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Series%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="toc-number">13.</span> <span class="toc-text">Series查看数据基本信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%94%AF%E4%B8%80%E6%80%A7"><span class="toc-number">13.1.</span> <span class="toc-text">检查唯一性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E5%B1%95%E7%A4%BA"><span class="toc-number">13.1.1.</span> <span class="toc-text">方法展示</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#assert"><span class="toc-number">13.1.1.1.</span> <span class="toc-text">assert</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E9%95%BF%E5%BA%A6"><span class="toc-number">13.2.</span> <span class="toc-text">检查长度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E7%A9%BA%E5%80%BC"><span class="toc-number">13.3.</span> <span class="toc-text">检查空值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dick-like%E9%80%89%E6%8B%A9%E6%95%B0%E6%8D%AE"><span class="toc-number">14.</span> <span class="toc-text">dick-like选择数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mask%E9%80%89%E5%8F%96"><span class="toc-number">14.1.</span> <span class="toc-text">mask选取</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#list-like%E5%88%87%E7%89%87%E9%80%89%E6%95%B0%E6%8D%AE"><span class="toc-number">15.</span> <span class="toc-text">list-like切片选数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#loc%E9%80%89%E6%95%B0%E6%8D%AE"><span class="toc-number">16.</span> <span class="toc-text">loc选数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iloc%E9%80%89%E6%8B%A9%E6%95%B0%E6%8D%AE"><span class="toc-number">17.</span> <span class="toc-text">iloc选择数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mutilndex%E5%A4%9A%E5%B1%82%E7%B4%A2%E5%BC%95"><span class="toc-number">18.</span> <span class="toc-text">Mutilndex多层索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%86%99%E5%A4%9A%E5%B1%82%E7%B4%A2%E5%BC%95excel%E8%A1%A8"><span class="toc-number">18.1.</span> <span class="toc-text">读写多层索引excel表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%A4%9A%E5%B1%82%E7%B4%A2%E5%BC%95"><span class="toc-number">18.2.</span> <span class="toc-text">创建多层索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#list-like%E5%88%9B%E5%BB%BA%E6%B3%95"><span class="toc-number">18.2.1.</span> <span class="toc-text">list-like创建法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF%E5%88%9B%E5%BB%BA"><span class="toc-number">18.2.2.</span> <span class="toc-text">笛卡尔积创建</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%B2%E6%9C%89%E8%A1%A8%E6%A0%BC%E5%9F%BA%E7%A1%80%E7%94%9F%E6%88%90Multindex"><span class="toc-number">18.3.</span> <span class="toc-text">已有表格基础生成Multindex</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%94%9F%E6%88%90%E9%9A%8F%E6%9C%BA%E6%A0%B7%E6%9C%AC"><span class="toc-number">18.3.1.</span> <span class="toc-text">自定义生成随机样本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E5%B1%82%E7%B4%A2%E5%BC%95%E5%8F%96%E5%80%BC"><span class="toc-number">18.3.2.</span> <span class="toc-text">多层索引取值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%B5%8B%E5%80%BC"><span class="toc-number">18.4.</span> <span class="toc-text">数据赋值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-number">19.</span> <span class="toc-text">缺失值</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%B5%8B%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-number">19.1.</span> <span class="toc-text">检测缺失值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-number">19.2.</span> <span class="toc-text">删除缺失值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A1%AB%E5%85%85%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-number">19.3.</span> <span class="toc-text">填充缺失值</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E5%B7%A5%E4%BD%9C%E4%B8%AD%E6%9C%80%E5%B8%B8%E7%94%A8"><span class="toc-number">19.3.1.</span> <span class="toc-text">实际工作中最常用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E6%8F%92%E5%80%BC"><span class="toc-number">19.4.</span> <span class="toc-text">线性插值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E8%BF%90%E7%AE%97"><span class="toc-number">20.</span> <span class="toc-text">数值运算</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">20.1.</span> <span class="toc-text">需要注意的问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E7%A9%BA%E5%80%BC%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">20.1.1.</span> <span class="toc-text">对空值的处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E9%99%A4%E6%95%B0%E4%B8%BA0%E7%9A%84%E6%95%B0"><span class="toc-number">20.1.2.</span> <span class="toc-text">对除数为0的数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Series%E4%B8%8D%E5%AF%B9%E9%BD%90%E6%83%85%E5%86%B5"><span class="toc-number">20.2.</span> <span class="toc-text">Series不对齐情况</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#dataframe%E6%83%85%E5%86%B5%E4%B8%BE%E4%BE%8B"><span class="toc-number">20.2.1.</span> <span class="toc-text">dataframe情况举例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Muitindex%E5%AE%9E%E7%8E%B0"><span class="toc-number">20.3.</span> <span class="toc-text">Muitindex实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">21.</span> <span class="toc-text">字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C"><span class="toc-number">21.1.</span> <span class="toc-text">字符串操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#findall"><span class="toc-number">21.1.1.</span> <span class="toc-text">findall()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#search"><span class="toc-number">21.1.2.</span> <span class="toc-text">search()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#split"><span class="toc-number">21.1.3.</span> <span class="toc-text">split()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sub"><span class="toc-number">21.1.4.</span> <span class="toc-text">sub()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#replace"><span class="toc-number">21.1.5.</span> <span class="toc-text">replace()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cat"><span class="toc-number">21.1.6.</span> <span class="toc-text">cat()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#str%E5%8F%96%E5%80%BC%E4%B8%8E%E5%88%87%E7%89%87"><span class="toc-number">21.1.7.</span> <span class="toc-text">str取值与切片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#extract-%E6%8F%90%E5%8F%96"><span class="toc-number">21.1.8.</span> <span class="toc-text">extract()提取</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#contain"><span class="toc-number">21.1.9.</span> <span class="toc-text">contain()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#get-dummies-%E8%8E%B7%E5%8F%96%E7%8B%AC%E7%83%AD%E7%BC%96%E7%A0%81"><span class="toc-number">21.1.10.</span> <span class="toc-text">get_dummies()获取独热编码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#count-len"><span class="toc-number">21.1.11.</span> <span class="toc-text">count()&#x2F;len()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pad-%E5%A1%AB%E5%85%85"><span class="toc-number">21.1.12.</span> <span class="toc-text">pad()填充</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#string%E7%B1%BB%E5%9E%8B"><span class="toc-number">21.2.</span> <span class="toc-text">string类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%99%A8"><span class="toc-number">21.3.</span> <span class="toc-text">访问器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%99%A8%E5%BA%94%E7%94%A8%E5%AE%9E%E6%93%8D"><span class="toc-number">21.3.1.</span> <span class="toc-text">访问器应用实操</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4"><span class="toc-number">22.</span> <span class="toc-text">时间</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="toc-number">22.1.</span> <span class="toc-text">时间类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%82%B9-%E6%97%B6%E9%97%B4%E6%AE%B5"><span class="toc-number">22.2.</span> <span class="toc-text">时间点&#x2F;时间段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%A2%9E%E9%87%8F-%E6%97%B6%E9%97%B4%E5%81%8F%E7%A7%BB"><span class="toc-number">22.3.</span> <span class="toc-text">时间增量&#x2F;时间偏移</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E6%BC%94%E7%A4%BA"><span class="toc-number">22.3.1.</span> <span class="toc-text">实例演示</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A2%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97"><span class="toc-number">22.4.</span> <span class="toc-text">转换时间序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%97%B6%E9%97%B4%E6%88%B3%E8%8C%83%E5%9B%B4"><span class="toc-number">22.5.</span> <span class="toc-text">生成时间戳范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E8%AE%BF%E9%97%AE%E5%99%A8"><span class="toc-number">22.6.</span> <span class="toc-text">时间序列访问器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7"><span class="toc-number">22.6.1.</span> <span class="toc-text">属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95"><span class="toc-number">22.6.2.</span> <span class="toc-text">方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Period%E5%88%9B%E5%BB%BA"><span class="toc-number">22.7.</span> <span class="toc-text">Period创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Timetelta%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94"><span class="toc-number">22.8.</span> <span class="toc-text">Timetelta时间间隔</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Timedelta"><span class="toc-number">22.8.1.</span> <span class="toc-text">Timedelta()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#to-timedelta"><span class="toc-number">22.8.2.</span> <span class="toc-text">to_timedelta()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#timedelta-range"><span class="toc-number">22.8.3.</span> <span class="toc-text">timedelta_range()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E7%B4%A2%E5%BC%95"><span class="toc-number">22.9.</span> <span class="toc-text">时间序列索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-number">22.9.1.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="toc-number">22.9.2.</span> <span class="toc-text">注意点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E5%90%88%E5%B9%B6"><span class="toc-number">23.</span> <span class="toc-text">多表合并</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#append-%E4%B8%8A%E4%B8%8B%E5%90%88%E5%B9%B6"><span class="toc-number">23.1.</span> <span class="toc-text">append()上下合并</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E6%BC%94%E7%A4%BA-1"><span class="toc-number">23.1.1.</span> <span class="toc-text">实例演示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%88%E5%B9%B6%E6%96%87%E4%BB%B6%E5%A4%B9%E7%9A%84%E8%A1%A8%E6%A0%BC"><span class="toc-number">23.1.2.</span> <span class="toc-text">合并文件夹的表格</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#join-%E5%B7%A6%E5%8F%B3%E5%90%88%E5%B9%B6"><span class="toc-number">23.2.</span> <span class="toc-text">join()左右合并</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%BC%E6%8E%A5series"><span class="toc-number">23.2.1.</span> <span class="toc-text">拼接series</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%BC%E6%8E%A5dataframe"><span class="toc-number">23.2.2.</span> <span class="toc-text">拼接dataframe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E6%BC%94%E7%A4%BA-2"><span class="toc-number">23.2.3.</span> <span class="toc-text">实例演示</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#concat-%E5%B7%A6%E5%8F%B3-%E4%B8%8A%E4%B8%8B%E5%90%88%E5%B9%B6"><span class="toc-number">23.3.</span> <span class="toc-text">concat()左右&#x2F;上下合并</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E6%AC%A1%E6%80%A7%E8%AF%BB%E5%A4%9A%E8%A1%A8"><span class="toc-number">23.3.1.</span> <span class="toc-text">一次性读多表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#keys%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">23.3.2.</span> <span class="toc-text">keys的作用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#merge-%E8%81%94%E5%90%88"><span class="toc-number">23.4.</span> <span class="toc-text">merge()联合</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%9A1"><span class="toc-number">23.4.1.</span> <span class="toc-text">1：1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M%EF%BC%9A1"><span class="toc-number">23.4.2.</span> <span class="toc-text">M：1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M%EF%BC%9AM"><span class="toc-number">23.4.3.</span> <span class="toc-text">M：M</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E8%83%BD%E4%BC%9A%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">23.4.4.</span> <span class="toc-text">可能会遇到的问题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#validate"><span class="toc-number">23.4.4.1.</span> <span class="toc-text">validate</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%88%97%E8%A1%A8%E5%85%B1%E5%90%8C%E5%8C%B9%E9%85%8D"><span class="toc-number">23.4.5.</span> <span class="toc-text">使用列表共同匹配</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%8F%E8%A7%86%E8%A1%A8"><span class="toc-number">24.</span> <span class="toc-text">透视表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pivot"><span class="toc-number">24.1.</span> <span class="toc-text">pivot()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pivot-table-1"><span class="toc-number">24.2.</span> <span class="toc-text">pivot_table()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">24.3.</span> <span class="toc-text">聚合函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-number">25.</span> <span class="toc-text">排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sort-index"><span class="toc-number">25.1.</span> <span class="toc-text">sort_index()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ascending"><span class="toc-number">25.1.1.</span> <span class="toc-text">ascending</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#soft-values"><span class="toc-number">25.2.</span> <span class="toc-text">soft_values()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CateGoricalDtype"><span class="toc-number">25.3.</span> <span class="toc-text">CateGoricalDtype()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-number">25.3.1.</span> <span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F%E6%8B%93%E5%B1%95"><span class="toc-number">25.4.</span> <span class="toc-text">排序拓展</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%BB%84"><span class="toc-number">26.</span> <span class="toc-text">分组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#groupby-%E5%88%86%E7%BB%84"><span class="toc-number">26.1.</span> <span class="toc-text">groupby()分组</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%86%E5%88%86%E5%A4%9A%E4%B8%AA%E7%BB%84"><span class="toc-number">26.1.1.</span> <span class="toc-text">拆分多个组</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#PPT%E6%BC%94%E7%A4%BA"><span class="toc-number">26.1.1.1.</span> <span class="toc-text">PPT演示</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E9%AA%8C%E8%AF%81"><span class="toc-number">26.1.1.2.</span> <span class="toc-text">代码验证</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%90%8E%E6%93%8D%E4%BD%9C"><span class="toc-number">26.1.2.</span> <span class="toc-text">分组后操作</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%81%9A%E5%90%88"><span class="toc-number">26.1.2.1.</span> <span class="toc-text">聚合</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A2"><span class="toc-number">26.1.2.2.</span> <span class="toc-text">转换</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4"><span class="toc-number">26.1.2.3.</span> <span class="toc-text">过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%87%8D%E6%96%B0%E5%8A%A0%E5%9B%9E%E8%B4%A7%E5%8F%B7"><span class="toc-number">26.1.2.3.1.</span> <span class="toc-text">重新加回货号</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0-1"><span class="toc-number">26.2.</span> <span class="toc-text">聚合函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#first"><span class="toc-number">26.2.1.</span> <span class="toc-text">first()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nth"><span class="toc-number">26.2.2.</span> <span class="toc-text">nth()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#size"><span class="toc-number">26.2.3.</span> <span class="toc-text">size()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#count"><span class="toc-number">26.2.4.</span> <span class="toc-text">count()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E5%85%B8%E4%BC%A0%E5%85%A5"><span class="toc-number">26.3.</span> <span class="toc-text">字典传入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E6%9D%A1%E4%BB%B6%E6%98%AF%E5%90%A6%E5%81%9A%E7%B4%A2%E5%BC%95"><span class="toc-number">26.4.</span> <span class="toc-text">分组条件是否做索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%90%8E%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%84%E7%90%86"><span class="toc-number">26.5.</span> <span class="toc-text">分组后自定义处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3"><span class="toc-number">27.</span> <span class="toc-text">窗口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">27.1.</span> <span class="toc-text">基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%9C%80%E5%B0%8F%E8%A7%82%E6%B5%8B"><span class="toc-number">27.2.</span> <span class="toc-text">修改最小观测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%AF%B9%E9%BD%90%E6%96%B9%E5%BC%8F"><span class="toc-number">27.3.</span> <span class="toc-text">修改对齐方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E7%AA%97%E5%8F%A3%E6%9D%83%E9%87%8D"><span class="toc-number">27.4.</span> <span class="toc-text">修改窗口权重</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%8F%96%E5%80%BC%E8%8C%83%E5%9B%B4"><span class="toc-number">27.5.</span> <span class="toc-text">窗口取值范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E7%AA%97%E5%8F%A3"><span class="toc-number">27.6.</span> <span class="toc-text">扩展窗口</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E5%A4%9A%E5%AE%9E%E7%94%A8%E5%87%BD%E6%95%B0%E6%96%B9%E6%B3%95"><span class="toc-number">28.</span> <span class="toc-text">更多实用函数方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%B7%B2%E6%9C%89%E5%88%97%E8%AE%BE%E7%BD%AE%E4%B8%BAindex"><span class="toc-number">28.1.</span> <span class="toc-text">将已有列设置为index</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A2index%E4%B8%BA%E5%88%97"><span class="toc-number">28.2.</span> <span class="toc-text">转换index为列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%97%E5%90%8D%E9%87%8D%E7%BB%84"><span class="toc-number">28.3.</span> <span class="toc-text">自定义列名重组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%83%8Fdf2%E4%B8%80%E6%A0%B7"><span class="toc-number">28.4.</span> <span class="toc-text">像df2一样</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%91%BD%E5%90%8D%E7%B4%A2%E5%BC%95"><span class="toc-number">28.5.</span> <span class="toc-text">重命名索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#where%E6%9D%A1%E4%BB%B6%E9%80%89%E6%8B%A9%E6%95%B0%E6%8D%AE"><span class="toc-number">28.6.</span> <span class="toc-text">where条件选择数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E5%8C%BA%E9%97%B4%E5%88%86%E7%B1%BB"><span class="toc-number">28.7.</span> <span class="toc-text">根据区间分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E8%AE%B0%E9%87%8D%E5%A4%8D%E5%80%BC"><span class="toc-number">28.8.</span> <span class="toc-text">标记重复值</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%A2%E5%BC%83%E9%87%8D%E5%A4%8D%E5%80%BC"><span class="toc-number">28.8.1.</span> <span class="toc-text">丢弃重复值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E5%8F%96%E6%A0%B7"><span class="toc-number">28.9.</span> <span class="toc-text">随机取样</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E6%96%B0%E9%87%87%E6%A0%B7"><span class="toc-number">28.10.</span> <span class="toc-text">重新采样</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-1"><span class="toc-number">28.10.1.</span> <span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#apply-%E5%BA%94%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">28.11.</span> <span class="toc-text">apply()应用函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%A0%E5%85%A5python-func"><span class="toc-number">28.11.1.</span> <span class="toc-text">传入python func</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%90%8D"><span class="toc-number">28.12.</span> <span class="toc-text">排名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0"><span class="toc-number">28.13.</span> <span class="toc-text">堆叠</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%97%E7%B4%A2%E5%BC%95%E5%A0%86%E5%8F%A0%E4%BA%8E%E8%A1%8C%E7%B4%A2%E5%BC%95"><span class="toc-number">28.13.1.</span> <span class="toc-text">列索引堆叠于行索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%8C%E7%B4%A2%E5%BC%95%E5%8F%8D%E5%A0%86%E5%8F%A0%E4%BA%8E%E5%88%97%E7%B4%A2%E5%BC%95"><span class="toc-number">28.13.2.</span> <span class="toc-text">行索引反堆叠于列索引</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#max-min"><span class="toc-number">28.14.</span> <span class="toc-text">max&#x2F;min</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#idxmax-min"><span class="toc-number">28.14.1.</span> <span class="toc-text">idxmax&#x2F;min</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#argmax-min"><span class="toc-number">28.14.2.</span> <span class="toc-text">argmax&#x2F;min</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nlargest-nsmallest"><span class="toc-number">28.14.3.</span> <span class="toc-text">nlargest&#x2F;nsmallest</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%B9%B6%E7%AD%9B%E9%80%89%E8%A1%8C"><span class="toc-number">28.15.</span> <span class="toc-text">查询并筛选行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E5%90%8D%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%95%B0%E6%8D%AE"><span class="toc-number">28.16.</span> <span class="toc-text">列名转化为数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%99%E4%BD%8D%E7%9B%B8%E5%87%8F"><span class="toc-number">28.17.</span> <span class="toc-text">错位相减</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%8F%E7%A7%BB%E6%95%B0%E6%8D%AE-%E6%97%B6%E9%97%B4%E7%B4%A2%E5%BC%95"><span class="toc-number">28.18.</span> <span class="toc-text">偏移数据&#x2F;时间索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BE%E5%88%86%E6%AF%94%E5%8F%98%E5%8C%96%E6%83%85%E5%86%B5"><span class="toc-number">28.19.</span> <span class="toc-text">百分比变化情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0"><span class="toc-number">28.20.</span> <span class="toc-text">更新</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-number">29.</span> <span class="toc-text">数据可视化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%AF%E6%8C%81%E5%9B%BE%E7%9A%84%E7%A7%8D%E7%B1%BB"><span class="toc-number">29.1.</span> <span class="toc-text">支持图的种类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#matplotlib-pyplot"><span class="toc-number">29.2.</span> <span class="toc-text">matplotlib.pyplot()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E9%98%B6%E6%AE%B5"><span class="toc-number">29.2.1.</span> <span class="toc-text">准备阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#figure"><span class="toc-number">29.2.2.</span> <span class="toc-text">figure()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pyplot-style"><span class="toc-number">29.3.</span> <span class="toc-text">pyplot-style</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OO-style"><span class="toc-number">29.4.</span> <span class="toc-text">OO-style</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E5%A4%9A%E5%9B%BE"><span class="toc-number">29.5.</span> <span class="toc-text">绘制多图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%BD%A2%E5%BC%8F"><span class="toc-number">29.5.1.</span> <span class="toc-text">面向对象的形式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rcParams%E5%85%A8%E5%B1%80%E5%8F%82%E6%95%B0"><span class="toc-number">29.6.</span> <span class="toc-text">rcParams全局参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#colormaps"><span class="toc-number">29.7.</span> <span class="toc-text">colormaps</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E9%A2%9C%E8%89%B2%E3%80%81%E7%BA%BF%E6%9D%A1%E3%80%81%E7%82%B9%E6%A0%B7%E5%BC%8F"><span class="toc-number">29.8.</span> <span class="toc-text">设置颜色、线条、点样式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#color"><span class="toc-number">29.8.1.</span> <span class="toc-text">color</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#marker"><span class="toc-number">29.8.2.</span> <span class="toc-text">marker</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#line"><span class="toc-number">29.8.3.</span> <span class="toc-text">line</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#seaborn"><span class="toc-number">29.9.</span> <span class="toc-text">seaborn</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#load-dataset"><span class="toc-number">29.9.1.</span> <span class="toc-text">load_dataset()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#set"><span class="toc-number">29.9.2.</span> <span class="toc-text">set()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#seaborn%E5%9B%BE%E4%BE%8B%E5%85%B3%E7%B3%BB"><span class="toc-number">29.9.3.</span> <span class="toc-text">seaborn图例关系</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E5%9B%BE"><span class="toc-number">29.9.3.1.</span> <span class="toc-text">关系图</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%E5%9B%BE"><span class="toc-number">29.9.3.2.</span> <span class="toc-text">分类图</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%95%A3%E7%82%B9"><span class="toc-number">29.9.3.2.1.</span> <span class="toc-text">散点</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%86%E5%B8%83"><span class="toc-number">29.9.3.2.2.</span> <span class="toc-text">分布</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BC%B0%E8%AE%A1"><span class="toc-number">29.9.3.2.3.</span> <span class="toc-text">估计</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%9B%BE"><span class="toc-number">29.9.3.3.</span> <span class="toc-text">分布图</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%87%8D%E7%82%B9"><span class="toc-number">29.9.3.4.</span> <span class="toc-text">重点</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Olympic%E5%AE%9E%E6%88%98"><span class="toc-number">29.9.4.</span> <span class="toc-text">Olympic实战</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%88%E5%B9%B6%E6%A3%80%E6%9F%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">29.9.4.1.</span> <span class="toc-text">合并检查数据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%A3%E7%82%B9%E5%9B%BE%E7%BB%98%E5%88%B6"><span class="toc-number">29.9.4.2.</span> <span class="toc-text">散点图绘制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BA%BF%E5%9B%BE"><span class="toc-number">29.9.4.3.</span> <span class="toc-text">线图</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9D%A1%E5%BD%A2%E5%9B%BE"><span class="toc-number">29.9.4.4.</span> <span class="toc-text">条形图</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E9%87%8F%E6%9D%A1%E5%BD%A2%E5%9B%BE"><span class="toc-number">29.9.4.5.</span> <span class="toc-text">数量条形图</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AE%B1%E5%9E%8B%E5%9B%BE"><span class="toc-number">29.9.4.6.</span> <span class="toc-text">箱型图</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%86%E5%BA%A6%E5%9B%BE"><span class="toc-number">29.9.4.7.</span> <span class="toc-text">密度图</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%8F%E6%8F%90%E7%90%B4%E5%9B%BE"><span class="toc-number">29.9.4.8.</span> <span class="toc-text">*小提琴图</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%9B%BE-1"><span class="toc-number">29.9.4.9.</span> <span class="toc-text">*分布图</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#figure-level-%E5%92%8C-axes-level"><span class="toc-number">29.9.5.</span> <span class="toc-text">figure-level 和 axes-level</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#FacetGrid-%E6%96%B9%E6%B3%95"><span class="toc-number">29.9.5.1.</span> <span class="toc-text">FacetGrid 方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#FacetGrid-%E5%B1%9E%E6%80%A7"><span class="toc-number">29.9.5.2.</span> <span class="toc-text">FacetGrid 属性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%BC%94%E7%A4%BA"><span class="toc-number">29.9.5.3.</span> <span class="toc-text">演示</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%82%B9%E5%9B%BE"><span class="toc-number">29.9.6.</span> <span class="toc-text">点图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%83%AD%E5%8A%9B%E5%9B%BE"><span class="toc-number">29.9.7.</span> <span class="toc-text">热力图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E5%BD%92%E5%9B%BE"><span class="toc-number">29.9.8.</span> <span class="toc-text">回归图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E9%A2%9C%E8%89%B2%E7%BA%BF%E5%9B%BE"><span class="toc-number">29.9.9.</span> <span class="toc-text">高级颜色线图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AD%E9%9D%A2%E4%BD%93-%E6%9F%B1%E7%8A%B6%E5%9B%BE"><span class="toc-number">29.9.10.</span> <span class="toc-text">六面体+柱状图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A9%AC%E8%B5%9B%E5%85%8B-%E6%9F%B1%E7%8A%B6%E5%9B%BE"><span class="toc-number">29.9.11.</span> <span class="toc-text">马赛克+柱状图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0%E7%9B%B4%E6%96%B9%E5%9B%BE"><span class="toc-number">29.9.12.</span> <span class="toc-text">堆叠直方图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%B1%E5%9E%8B-%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="toc-number">29.9.13.</span> <span class="toc-text">箱型+散点图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%98%E9%99%B5%E5%AF%86%E5%BA%A6%E5%9B%BE"><span class="toc-number">29.9.14.</span> <span class="toc-text">丘陵密度图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E7%BB%B4%E5%BA%A6%E5%AF%86%E5%BA%A6%E8%81%9A%E7%B1%BB"><span class="toc-number">29.9.15.</span> <span class="toc-text">多维度密度聚类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%B1%E7%9B%92%E5%9B%BE"><span class="toc-number">29.9.16.</span> <span class="toc-text">箱盒图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AB%98%E8%B4%B5%E8%93%9D%E5%AE%9D%E7%9F%B3%E5%AF%86%E5%BA%A6%E5%9B%BE"><span class="toc-number">29.9.17.</span> <span class="toc-text">高贵蓝宝石密度图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#logistic%E6%9B%B2%E7%BA%BF%E7%BB%98%E5%88%B6"><span class="toc-number">29.9.18.</span> <span class="toc-text">logistic曲线绘制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A5%E9%95%BF%E5%9B%BE"><span class="toc-number">29.9.19.</span> <span class="toc-text">步长图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8A%E7%83%AD%E5%8A%9B%E5%9B%BE"><span class="toc-number">29.9.20.</span> <span class="toc-text">半热力图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E5%BD%92-%E5%88%86%E5%B8%83%E5%9B%BE"><span class="toc-number">29.9.21.</span> <span class="toc-text">回归+分布图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AE%8B%E5%B7%AE%E5%9B%BE"><span class="toc-number">29.9.22.</span> <span class="toc-text">残差图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%A3%E7%82%B9-%E5%88%86%E5%B8%83%E5%9B%BE"><span class="toc-number">29.9.23.</span> <span class="toc-text">散点+分布图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%B1%E9%82%83%E7%83%AD%E5%8A%9B-%E6%9D%A1%E5%BD%A2"><span class="toc-number">29.9.24.</span> <span class="toc-text">深邃热力+条形</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%A6%E5%9B%9E%E5%BD%92%E7%BA%BF%E7%9A%84%E6%95%A3%E7%82%B9%E6%9D%A1%E5%BD%A2%E5%9B%BE"><span class="toc-number">29.9.25.</span> <span class="toc-text">带回归线的散点条形图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%83%AD%E5%8A%9B%E5%9B%BE-%E6%A0%91%E7%8A%B6%E5%9B%BE"><span class="toc-number">29.9.26.</span> <span class="toc-text">热力图+树状图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E9%87%8D%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97"><span class="toc-number">29.9.27.</span> <span class="toc-text">多重时间序列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%B0%E5%AF%8C%E5%A4%9A%E5%BD%A9%E7%9A%84%E7%BA%BF%E5%9B%BE"><span class="toc-number">29.9.28.</span> <span class="toc-text">丰富多彩的线图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90Mp4%EF%BC%8Cgif"><span class="toc-number">29.9.29.</span> <span class="toc-text">生成Mp4，gif</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E5%9B%BE%E5%90%8C%E5%B1%8F%E7%89%88%E6%9C%AC"><span class="toc-number">29.9.29.1.</span> <span class="toc-text">多图同屏版本</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E6%88%98"><span class="toc-number">30.</span> <span class="toc-text">实战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%AD%A5%E9%AA%A4"><span class="toc-number">30.1.</span> <span class="toc-text">主要步骤</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://s2.loli.net/2022/04/15/YXoFfbxgWZIn1SM.png')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By jjyaoao</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/algolia.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Livere' === 'Livere' || !true) {
  if (true) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'cFvw1zyA64uttBS5jbYY7pwH-gzGzoHsz',
      appKey: '14rOjAUNzRyJSQt983q6gdza',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Livere' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善,感谢" data-fontsize="15px" data-random="false" async="async"></script><script>(function(d, w, c) {
    w.ChatraID = 'zgYNWkNCSATLRhpg4';
    var s = d.createElement('script');
    w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
    };
    s.async = true;
    s.src = 'https://call.chatra.io/chatra.js';
    if (d.head) d.head.appendChild(s);
})(document, window, 'Chatra');

if (true) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      Chatra('openChat')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      Chatra('hide')
    }
    function chatBtnShow () {
      Chatra('show')
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>